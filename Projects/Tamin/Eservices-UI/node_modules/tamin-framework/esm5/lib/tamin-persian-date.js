/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
// Based on https://github.com/jalaali/jalaali-js
var TaminPersianDate = /** @class */ (function () {
    function TaminPersianDate() {
        this.breaks = [-61, 9, 38, 199, 426, 686, 756, 818, 1111, 1181, 1210,
            1635, 2060, 2097, 2192, 2262, 2324, 2394, 2456, 3178
        ];
    }
    /**
     * @param {?} date
     * @return {?}
     */
    TaminPersianDate.GregorianToJalali = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        /** @type {?} */
        var tmp = TaminPersianDate.taminPersianDate.toJalaali(date.getFullYear(), date.getMonth() + 1, date.getDate());
        return tmp.jy + "/" + TaminPersianDate.setLeadingZero(tmp.jm) + "/" + TaminPersianDate.setLeadingZero(tmp.jd);
    };
    /**
     * @private
     * @param {?} val
     * @return {?}
     */
    TaminPersianDate.setLeadingZero = /**
     * @private
     * @param {?} val
     * @return {?}
     */
    function (val) {
        if (Number(val) < 10) {
            return '0' + val.toString();
        }
        return val.toString();
    };
    /**
     * @param {?} year
     * @param {?} month
     * @param {?} day
     * @return {?}
     */
    TaminPersianDate.JalaliToGregorian = /**
     * @param {?} year
     * @param {?} month
     * @param {?} day
     * @return {?}
     */
    function (year, month, day) {
        if (TaminPersianDate.taminPersianDate.isValidJalaaliDate(year, month, day)) {
            /** @type {?} */
            var tmp = TaminPersianDate.taminPersianDate.toGregorian(year, month, day);
            return new Date(tmp.gy, tmp.gm - 1, tmp.gd, 0, 0, 0, 0);
        }
        throw new Error('Invalid parameters');
    };
    /**
     * @param {?} date
     * @return {?}
     */
    TaminPersianDate.FirstDayInMonth = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        /** @type {?} */
        var tmp = TaminPersianDate.taminPersianDate.toJalaali(date.getFullYear(), date.getMonth() + 1, date.getDate());
        return TaminPersianDate.JalaliToGregorian(tmp.jy, tmp.jm, 1);
    };
    /**
     * @param {?} date
     * @return {?}
     */
    TaminPersianDate.GetNextMonth = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        /** @type {?} */
        var tmp = TaminPersianDate.taminPersianDate.toJalaali(date.getFullYear(), date.getMonth() + 1, date.getDate());
        /** @type {?} */
        var month = tmp.jm + 1;
        /** @type {?} */
        var year = tmp.jy;
        /** @type {?} */
        var day = tmp.jd;
        if (month > 12) {
            month = 1;
            year += 1;
        }
        if (month > 6 && day > 30) {
            day = 30;
        }
        if (month === 12 && TaminPersianDate.taminPersianDate.isLeapJalaaliYear(year) && day > 29) {
            day = 29;
        }
        return TaminPersianDate.JalaliToGregorian(year, month, day);
    };
    /**
     * @param {?} date
     * @return {?}
     */
    TaminPersianDate.GetPrevMonth = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        /** @type {?} */
        var tmp = TaminPersianDate.taminPersianDate.toJalaali(date.getFullYear(), date.getMonth() + 1, date.getDate());
        /** @type {?} */
        var month = tmp.jm - 1;
        /** @type {?} */
        var year = tmp.jy;
        /** @type {?} */
        var day = tmp.jd;
        if (month === 0) {
            month = 1;
            year -= 1;
        }
        if (month > 6 && day > 30) {
            day = 30;
        }
        if (month === 12 && TaminPersianDate.taminPersianDate.isLeapJalaaliYear(year) && day > 29) {
            day = 29;
        }
        return TaminPersianDate.JalaliToGregorian(year, month, day);
    };
    /*
    Converts a Gregorian date to Jalaali.
    */
    /*
      Converts a Gregorian date to Jalaali.
      */
    /**
     * @param {?} gy
     * @param {?} gm
     * @param {?} gd
     * @return {?}
     */
    TaminPersianDate.prototype.toJalaali = /*
      Converts a Gregorian date to Jalaali.
      */
    /**
     * @param {?} gy
     * @param {?} gm
     * @param {?} gd
     * @return {?}
     */
    function (gy, gm, gd) {
        if (Object.prototype.toString.call(gy) === '[object Date]') {
            gd = gy.getDate();
            gm = gy.getMonth() + 1;
            gy = gy.getFullYear();
        }
        return this.d2j(this.g2d(gy, gm, gd));
    };
    /*
      Converts a Jalaali date to Gregorian.
    */
    /*
        Converts a Jalaali date to Gregorian.
      */
    /**
     * @param {?} jy
     * @param {?} jm
     * @param {?} jd
     * @return {?}
     */
    TaminPersianDate.prototype.toGregorian = /*
        Converts a Jalaali date to Gregorian.
      */
    /**
     * @param {?} jy
     * @param {?} jm
     * @param {?} jd
     * @return {?}
     */
    function (jy, jm, jd) {
        return this.d2g(this.j2d(jy, jm, jd));
    };
    /*
      Checks whether a Jalaali date is valid or not.
    */
    /*
        Checks whether a Jalaali date is valid or not.
      */
    /**
     * @param {?} jy
     * @param {?} jm
     * @param {?} jd
     * @return {?}
     */
    TaminPersianDate.prototype.isValidJalaaliDate = /*
        Checks whether a Jalaali date is valid or not.
      */
    /**
     * @param {?} jy
     * @param {?} jm
     * @param {?} jd
     * @return {?}
     */
    function (jy, jm, jd) {
        return jy >= -61 && jy <= 3177 &&
            jm >= 1 && jm <= 12 &&
            jd >= 1 && jd <= this.jalaaliMonthLength(jy, jm);
    };
    /*
      Is this a leap year or not?
    */
    /*
        Is this a leap year or not?
      */
    /**
     * @param {?} jy
     * @return {?}
     */
    TaminPersianDate.prototype.isLeapJalaaliYear = /*
        Is this a leap year or not?
      */
    /**
     * @param {?} jy
     * @return {?}
     */
    function (jy) {
        return this.jalCalLeap(jy) === 0;
    };
    /*
      Number of days in a given month in a Jalaali year.
    */
    /*
        Number of days in a given month in a Jalaali year.
      */
    /**
     * @param {?} jy
     * @param {?} jm
     * @return {?}
     */
    TaminPersianDate.prototype.jalaaliMonthLength = /*
        Number of days in a given month in a Jalaali year.
      */
    /**
     * @param {?} jy
     * @param {?} jm
     * @return {?}
     */
    function (jy, jm) {
        if (jm <= 6) {
            return 31;
        }
        if (jm <= 11) {
            return 30;
        }
        if (this.isLeapJalaaliYear(jy)) {
            return 30;
        }
        return 29;
    };
    /*
        This function determines if the Jalaali (Persian) year is
        leap (366-day long) or is the common year (365 days)
  
        @param jy Jalaali calendar year (-61 to 3177)
        @returns number of years since the last leap year (0 to 4)
     */
    /*
          This function determines if the Jalaali (Persian) year is
          leap (366-day long) or is the common year (365 days)
    
          @param jy Jalaali calendar year (-61 to 3177)
          @returns number of years since the last leap year (0 to 4)
       */
    /**
     * @param {?} jy
     * @return {?}
     */
    TaminPersianDate.prototype.jalCalLeap = /*
          This function determines if the Jalaali (Persian) year is
          leap (366-day long) or is the common year (365 days)
    
          @param jy Jalaali calendar year (-61 to 3177)
          @returns number of years since the last leap year (0 to 4)
       */
    /**
     * @param {?} jy
     * @return {?}
     */
    function (jy) {
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        var bl = this.breaks.length;
        /** @type {?} */
        var jp = this.breaks[0];
        /** @type {?} */
        var jm;
        /** @type {?} */
        var jump;
        /** @type {?} */
        var leap;
        /** @type {?} */
        var n;
        /** @type {?} */
        var i;
        if (jy < jp || jy >= this.breaks[bl - 1]) {
            throw new Error('Invalid Jalaali year ' + jy);
        }
        for (i = 1; i < bl; i += 1) {
            jm = this.breaks[i];
            jump = jm - jp;
            if (jy < jm) {
                break;
            }
            jp = jm;
        }
        n = jy - jp;
        if (jump - n < 6) {
            n = n - jump + this.div(jump + 4, 33) * 33;
        }
        leap = this.mod(this.mod(n + 1, 33) - 1, 4);
        if (leap === -1) {
            leap = 4;
        }
        return leap;
    };
    /*
      This function determines if the Jalaali (Persian) year is
      leap (366-day long) or is the common year (365 days), and
      finds the day in March (Gregorian calendar) of the first
      day of the Jalaali year (jy).
  
      @param jy Jalaali calendar year (-61 to 3177)
      @param withoutLeap when don't need leap (true or false) default is false
      @return
        leap: number of years since the last leap year (0 to 4)
        gy: Gregorian year of the beginning of Jalaali year
        march: the March day of Farvardin the 1st (1st day of jy)
      @see: http://www.astro.uni.torun.pl/~kb/Papers/EMP/PersianC-EMP.htm
      @see: http://www.fourmilab.ch/documents/calendar/
    */
    /*
        This function determines if the Jalaali (Persian) year is
        leap (366-day long) or is the common year (365 days), and
        finds the day in March (Gregorian calendar) of the first
        day of the Jalaali year (jy).
    
        @param jy Jalaali calendar year (-61 to 3177)
        @param withoutLeap when don't need leap (true or false) default is false
        @return
          leap: number of years since the last leap year (0 to 4)
          gy: Gregorian year of the beginning of Jalaali year
          march: the March day of Farvardin the 1st (1st day of jy)
        @see: http://www.astro.uni.torun.pl/~kb/Papers/EMP/PersianC-EMP.htm
        @see: http://www.fourmilab.ch/documents/calendar/
      */
    /**
     * @param {?} jy
     * @param {?} withoutLeap
     * @return {?}
     */
    TaminPersianDate.prototype.jalCal = /*
        This function determines if the Jalaali (Persian) year is
        leap (366-day long) or is the common year (365 days), and
        finds the day in March (Gregorian calendar) of the first
        day of the Jalaali year (jy).
    
        @param jy Jalaali calendar year (-61 to 3177)
        @param withoutLeap when don't need leap (true or false) default is false
        @return
          leap: number of years since the last leap year (0 to 4)
          gy: Gregorian year of the beginning of Jalaali year
          march: the March day of Farvardin the 1st (1st day of jy)
        @see: http://www.astro.uni.torun.pl/~kb/Papers/EMP/PersianC-EMP.htm
        @see: http://www.fourmilab.ch/documents/calendar/
      */
    /**
     * @param {?} jy
     * @param {?} withoutLeap
     * @return {?}
     */
    function (jy, withoutLeap) {
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        var bl = this.breaks.length
        // tslint:disable-next-line:prefer-const
        ;
        /** @type {?} */
        var gy = jy + 621;
        /** @type {?} */
        var leapJ = -14;
        /** @type {?} */
        var jp = this.breaks[0];
        /** @type {?} */
        var jm;
        /** @type {?} */
        var jump;
        /** @type {?} */
        var leap;
        /** @type {?} */
        var leapG;
        /** @type {?} */
        var march;
        /** @type {?} */
        var n;
        /** @type {?} */
        var i;
        if (jy < jp || jy >= this.breaks[bl - 1]) {
            throw new Error('Invalid Jalaali year ' + jy);
        }
        // Find the limiting years for the Jalaali year jy.
        for (i = 1; i < bl; i += 1) {
            jm = this.breaks[i];
            jump = jm - jp;
            if (jy < jm) {
                break;
            }
            leapJ = leapJ + this.div(jump, 33) * 8 + this.div(this.mod(jump, 33), 4);
            jp = jm;
        }
        n = jy - jp;
        // Find the number of leap years from AD 621 to the beginning
        // of the current Jalaali year in the Persian calendar.
        leapJ = leapJ + this.div(n, 33) * 8 + this.div(this.mod(n, 33) + 3, 4);
        if (this.mod(jump, 33) === 4 && jump - n === 4) {
            leapJ += 1;
        }
        // And the same in the Gregorian calendar (until the year gy).
        leapG = this.div(gy, 4) - this.div((this.div(gy, 100) + 1) * 3, 4) - 150;
        // Determine the Gregorian date of Farvardin the 1st.
        march = 20 + leapJ - leapG;
        // return with gy and march when we don't need leap
        if (withoutLeap) {
            return { gy: gy, march: march };
        }
        // Find how many years have passed since the last leap year.
        if (jump - n < 6) {
            n = n - jump + this.div(jump + 4, 33) * 33;
        }
        leap = this.mod(this.mod(n + 1, 33) - 1, 4);
        if (leap === -1) {
            leap = 4;
        }
        return {
            leap: leap,
            gy: gy,
            march: march
        };
    };
    /*
      Converts a date of the Jalaali calendar to the Julian Day number.
  
      @param jy Jalaali year (1 to 3100)
      @param jm Jalaali month (1 to 12)
      @param jd Jalaali day (1 to 29/31)
      @return Julian Day number
    */
    /*
        Converts a date of the Jalaali calendar to the Julian Day number.
    
        @param jy Jalaali year (1 to 3100)
        @param jm Jalaali month (1 to 12)
        @param jd Jalaali day (1 to 29/31)
        @return Julian Day number
      */
    /**
     * @param {?} jy
     * @param {?} jm
     * @param {?} jd
     * @return {?}
     */
    TaminPersianDate.prototype.j2d = /*
        Converts a date of the Jalaali calendar to the Julian Day number.
    
        @param jy Jalaali year (1 to 3100)
        @param jm Jalaali month (1 to 12)
        @param jd Jalaali day (1 to 29/31)
        @return Julian Day number
      */
    /**
     * @param {?} jy
     * @param {?} jm
     * @param {?} jd
     * @return {?}
     */
    function (jy, jm, jd) {
        /** @type {?} */
        var r = this.jalCal(jy, true);
        return this.g2d(r.gy, 3, r.march) + (jm - 1) * 31 - this.div(jm, 7) * (jm - 7) + jd - 1;
    };
    /*
      Converts the Julian Day number to a date in the Jalaali calendar.
  
      @param jdn Julian Day number
      @return
        jy: Jalaali year (1 to 3100)
        jm: Jalaali month (1 to 12)
        jd: Jalaali day (1 to 29/31)
    */
    /*
        Converts the Julian Day number to a date in the Jalaali calendar.
    
        @param jdn Julian Day number
        @return
          jy: Jalaali year (1 to 3100)
          jm: Jalaali month (1 to 12)
          jd: Jalaali day (1 to 29/31)
      */
    /**
     * @param {?} jdn
     * @return {?}
     */
    TaminPersianDate.prototype.d2j = /*
        Converts the Julian Day number to a date in the Jalaali calendar.
    
        @param jdn Julian Day number
        @return
          jy: Jalaali year (1 to 3100)
          jm: Jalaali month (1 to 12)
          jd: Jalaali day (1 to 29/31)
      */
    /**
     * @param {?} jdn
     * @return {?}
     */
    function (jdn) {
        // tslint:disable-next-line:prefer-const
        /** @type {?} */
        var gy = this.d2g(jdn).gy // Calculate Gregorian year (gy).
        ;
        /** @type {?} */
        var jy = gy - 621
        // tslint:disable-next-line:prefer-const
        ;
        /** @type {?} */
        var r = this.jalCal(jy, false)
        // tslint:disable-next-line:prefer-const
        ;
        /** @type {?} */
        var jdn1f = this.g2d(gy, 3, r.march);
        /** @type {?} */
        var jd;
        /** @type {?} */
        var jm;
        /** @type {?} */
        var k;
        // Find number of days that passed since 1 Farvardin.
        k = jdn - jdn1f;
        if (k >= 0) {
            if (k <= 185) {
                // The first 6 months.
                jm = 1 + this.div(k, 31);
                jd = this.mod(k, 31) + 1;
                return {
                    jy: jy,
                    jm: jm,
                    jd: jd
                };
            }
            else {
                // The remaining months.
                k -= 186;
            }
        }
        else {
            // Previous Jalaali year.
            jy -= 1;
            k += 179;
            if (r.leap === 1) {
                k += 1;
            }
        }
        jm = 7 + this.div(k, 30);
        jd = this.mod(k, 30) + 1;
        return {
            jy: jy,
            jm: jm,
            jd: jd
        };
    };
    /*
      Calculates the Julian Day number from Gregorian or Julian
      calendar dates. This integer number corresponds to the noon of
      the date (i.e. 12 hours of Universal Time).
      The procedure was tested to be good since 1 March, -100100 (of both
      calendars) up to a few million years into the future.
  
      @param gy Calendar year (years BC numbered 0, -1, -2, ...)
      @param gm Calendar month (1 to 12)
      @param gd Calendar day of the month (1 to 28/29/30/31)
      @return Julian Day number
    */
    /*
        Calculates the Julian Day number from Gregorian or Julian
        calendar dates. This integer number corresponds to the noon of
        the date (i.e. 12 hours of Universal Time).
        The procedure was tested to be good since 1 March, -100100 (of both
        calendars) up to a few million years into the future.
    
        @param gy Calendar year (years BC numbered 0, -1, -2, ...)
        @param gm Calendar month (1 to 12)
        @param gd Calendar day of the month (1 to 28/29/30/31)
        @return Julian Day number
      */
    /**
     * @param {?} gy
     * @param {?} gm
     * @param {?} gd
     * @return {?}
     */
    TaminPersianDate.prototype.g2d = /*
        Calculates the Julian Day number from Gregorian or Julian
        calendar dates. This integer number corresponds to the noon of
        the date (i.e. 12 hours of Universal Time).
        The procedure was tested to be good since 1 March, -100100 (of both
        calendars) up to a few million years into the future.
    
        @param gy Calendar year (years BC numbered 0, -1, -2, ...)
        @param gm Calendar month (1 to 12)
        @param gd Calendar day of the month (1 to 28/29/30/31)
        @return Julian Day number
      */
    /**
     * @param {?} gy
     * @param {?} gm
     * @param {?} gd
     * @return {?}
     */
    function (gy, gm, gd) {
        /** @type {?} */
        var d = this.div((gy + this.div(gm - 8, 6) + 100100) * 1461, 4)
            + this.div(153 * this.mod(gm + 9, 12) + 2, 5)
            + gd - 34840408;
        d = d - this.div(this.div(gy + 100100 + this.div(gm - 8, 6), 100) * 3, 4) + 752;
        return d;
    };
    /*
      Calculates Gregorian and Julian calendar dates from the Julian Day number
      (jdn) for the period since jdn=-34839655 (i.e. the year -100100 of both
      calendars) to some millions years ahead of the present.
  
      @param jdn Julian Day number
      @return
        gy: Calendar year (years BC numbered 0, -1, -2, ...)
        gm: Calendar month (1 to 12)
        gd: Calendar day of the month M (1 to 28/29/30/31)
    */
    /*
        Calculates Gregorian and Julian calendar dates from the Julian Day number
        (jdn) for the period since jdn=-34839655 (i.e. the year -100100 of both
        calendars) to some millions years ahead of the present.
    
        @param jdn Julian Day number
        @return
          gy: Calendar year (years BC numbered 0, -1, -2, ...)
          gm: Calendar month (1 to 12)
          gd: Calendar day of the month M (1 to 28/29/30/31)
      */
    /**
     * @param {?} jdn
     * @return {?}
     */
    TaminPersianDate.prototype.d2g = /*
        Calculates Gregorian and Julian calendar dates from the Julian Day number
        (jdn) for the period since jdn=-34839655 (i.e. the year -100100 of both
        calendars) to some millions years ahead of the present.
    
        @param jdn Julian Day number
        @return
          gy: Calendar year (years BC numbered 0, -1, -2, ...)
          gm: Calendar month (1 to 12)
          gd: Calendar day of the month M (1 to 28/29/30/31)
      */
    /**
     * @param {?} jdn
     * @return {?}
     */
    function (jdn) {
        /** @type {?} */
        var j;
        /** @type {?} */
        var i;
        /** @type {?} */
        var gd;
        /** @type {?} */
        var gm;
        /** @type {?} */
        var gy;
        j = 4 * jdn + 139361631;
        j = j + this.div(this.div(4 * jdn + 183187720, 146097) * 3, 4) * 4 - 3908;
        i = this.div(this.mod(j, 1461), 4) * 5 + 308;
        gd = this.div(this.mod(i, 153), 5) + 1;
        gm = this.mod(this.div(i, 153), 12) + 1;
        gy = this.div(j, 1461) - 100100 + this.div(8 - gm, 6);
        return {
            gy: gy,
            gm: gm,
            gd: gd
        };
    };
    /*
      Utility helper functions.
    */
    /*
        Utility helper functions.
      */
    /**
     * @param {?} a
     * @param {?} b
     * @return {?}
     */
    TaminPersianDate.prototype.div = /*
        Utility helper functions.
      */
    /**
     * @param {?} a
     * @param {?} b
     * @return {?}
     */
    function (a, b) {
        // tslint:disable-next-line:no-bitwise
        return ~~(a / b);
    };
    /**
     * @param {?} a
     * @param {?} b
     * @return {?}
     */
    TaminPersianDate.prototype.mod = /**
     * @param {?} a
     * @param {?} b
     * @return {?}
     */
    function (a, b) {
        // tslint:disable-next-line:no-bitwise
        return a - ~~(a / b) * b;
    };
    TaminPersianDate.taminPersianDate = new TaminPersianDate();
    return TaminPersianDate;
}());
export { TaminPersianDate };
if (false) {
    /**
     * @type {?}
     * @private
     */
    TaminPersianDate.taminPersianDate;
    /** @type {?} */
    TaminPersianDate.prototype.breaks;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFtaW4tcGVyc2lhbi1kYXRlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vdGFtaW4tZnJhbWV3b3JrLyIsInNvdXJjZXMiOlsibGliL3RhbWluLXBlcnNpYW4tZGF0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUNBO0lBQUE7UUFFUyxXQUFNLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJO1lBQ2xFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSTtTQUN2RCxDQUFDO0lBcVhKLENBQUM7Ozs7O0lBblhlLGtDQUFpQjs7OztJQUEvQixVQUFnQyxJQUFVOztZQUNsQyxHQUFHLEdBQUcsZ0JBQWdCLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUNoSCxPQUFVLEdBQUcsQ0FBQyxFQUFFLFNBQUksZ0JBQWdCLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsU0FBSSxnQkFBZ0IsQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBRyxDQUFDO0lBQzNHLENBQUM7Ozs7OztJQUVjLCtCQUFjOzs7OztJQUE3QixVQUE4QixHQUFHO1FBQy9CLElBQUksTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsRUFBRTtZQUNwQixPQUFPLEdBQUcsR0FBRyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUM7U0FDN0I7UUFDRCxPQUFPLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUN4QixDQUFDOzs7Ozs7O0lB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QUFFLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDeEMsRUFBRSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLE1BQU0sR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDdEQsT0FBTztZQUNMLEVBQUUsRUFBRSxFQUFFO1lBQ0osRUFBRSxFQUFFLEVBQUU7WUFDTixFQUFFLEVBQUUsRUFBRTtTQUNULENBQUM7SUFDSixDQUFDO0lBRUQ7O01BRUU7Ozs7Ozs7OztJQUNLLDhCQUFHOzs7Ozs7OztJQUFWLFVBQVcsQ0FBQyxFQUFFLENBQUM7UUFDYixzQ0FBc0M7UUFDdEMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDbkIsQ0FBQzs7Ozs7O0lBRU0sOEJBQUc7Ozs7O0lBQVYsVUFBVyxDQUFDLEVBQUUsQ0FBQztRQUNiLHNDQUFzQztRQUN0QyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUF2WGMsaUNBQWdCLEdBQUcsSUFBSSxnQkFBZ0IsRUFBRSxDQUFDO0lBd1gzRCx1QkFBQztDQUFBLEFBelhELElBeVhDO1NBelhZLGdCQUFnQjs7Ozs7O0lBQzNCLGtDQUF5RDs7SUFDekQsa0NBRUUiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBCYXNlZCBvbiBodHRwczovL2dpdGh1Yi5jb20vamFsYWFsaS9qYWxhYWxpLWpzXHJcbmV4cG9ydCBjbGFzcyBUYW1pblBlcnNpYW5EYXRlIHtcclxuICBwcml2YXRlIHN0YXRpYyB0YW1pblBlcnNpYW5EYXRlID0gbmV3IFRhbWluUGVyc2lhbkRhdGUoKTtcclxuICBwdWJsaWMgYnJlYWtzID0gWy02MSwgOSwgMzgsIDE5OSwgNDI2LCA2ODYsIDc1NiwgODE4LCAxMTExLCAxMTgxLCAxMjEwXHJcbiAgICAsIDE2MzUsIDIwNjAsIDIwOTcsIDIxOTIsIDIyNjIsIDIzMjQsIDIzOTQsIDI0NTYsIDMxNzhcclxuICBdO1xyXG5cclxuICBwdWJsaWMgc3RhdGljIEdyZWdvcmlhblRvSmFsYWxpKGRhdGU6IERhdGUpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgdG1wID0gVGFtaW5QZXJzaWFuRGF0ZS50YW1pblBlcnNpYW5EYXRlLnRvSmFsYWFsaShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSArIDEsIGRhdGUuZ2V0RGF0ZSgpKTtcclxuICAgIHJldHVybiBgJHt0bXAuanl9LyR7VGFtaW5QZXJzaWFuRGF0ZS5zZXRMZWFkaW5nWmVybyh0bXAuam0pfS8ke1RhbWluUGVyc2lhbkRhdGUuc2V0TGVhZGluZ1plcm8odG1wLmpkKX1gO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGF0aWMgc2V0TGVhZGluZ1plcm8odmFsKSB7XHJcbiAgICBpZiAoTnVtYmVyKHZhbCkgPCAxMCkge1xyXG4gICAgICByZXR1cm4gJzAnICsgdmFsLnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsLnRvU3RyaW5nKCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIEphbGFsaVRvR3JlZ29yaWFuKHllYXI6IG51bWJlciwgbW9udGg6IG51bWJlciwgZGF5OiBudW1iZXIpOiBEYXRlIHtcclxuICAgIGlmIChUYW1pblBlcnNpYW5EYXRlLnRhbWluUGVyc2lhbkRhdGUuaXNWYWxpZEphbGFhbGlEYXRlKHllYXIsIG1vbnRoLCBkYXkpKSB7XHJcbiAgICAgIGNvbnN0IHRtcCA9IFRhbWluUGVyc2lhbkRhdGUudGFtaW5QZXJzaWFuRGF0ZS50b0dyZWdvcmlhbih5ZWFyLCBtb250aCwgZGF5KTtcclxuICAgICAgcmV0dXJuIG5ldyBEYXRlKHRtcC5neSwgdG1wLmdtIC0gMSwgdG1wLmdkLCAwLCAwLCAwLCAwKTtcclxuICAgIH1cclxuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBwYXJhbWV0ZXJzJyk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3RhdGljIEZpcnN0RGF5SW5Nb250aChkYXRlOiBEYXRlKTogRGF0ZSB7XHJcbiAgICBjb25zdCB0bXAgPSBUYW1pblBlcnNpYW5EYXRlLnRhbWluUGVyc2lhbkRhdGUudG9KYWxhYWxpKGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpICsgMSwgZGF0ZS5nZXREYXRlKCkpO1xyXG4gICAgcmV0dXJuIFRhbWluUGVyc2lhbkRhdGUuSmFsYWxpVG9HcmVnb3JpYW4odG1wLmp5LCB0bXAuam0sIDEpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBHZXROZXh0TW9udGgoZGF0ZTogRGF0ZSk6IERhdGUge1xyXG4gICAgY29uc3QgdG1wID0gVGFtaW5QZXJzaWFuRGF0ZS50YW1pblBlcnNpYW5EYXRlLnRvSmFsYWFsaShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSArIDEsIGRhdGUuZ2V0RGF0ZSgpKTtcclxuICAgIGxldCBtb250aCA9IHRtcC5qbSArIDE7XHJcbiAgICBsZXQgeWVhciA9IHRtcC5qeTtcclxuICAgIGxldCBkYXkgPSB0bXAuamQ7XHJcblxyXG4gICAgaWYgKG1vbnRoID4gMTIpIHtcclxuICAgICAgbW9udGggPSAxO1xyXG4gICAgICB5ZWFyICs9IDE7XHJcbiAgICB9XHJcbiAgICAgaWYgKG1vbnRoID4gNiAmJiBkYXkgPiAzMCkge1xyXG4gICAgICAgZGF5ID0gMzA7XHJcbiAgICAgfVxyXG5cclxuICAgIGlmIChtb250aCA9PT0gMTIgJiYgVGFtaW5QZXJzaWFuRGF0ZS50YW1pblBlcnNpYW5EYXRlLmlzTGVhcEphbGFhbGlZZWFyKHllYXIpICYmIGRheSA+IDI5KSB7XHJcbiAgICAgIGRheSA9IDI5O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBUYW1pblBlcnNpYW5EYXRlLkphbGFsaVRvR3JlZ29yaWFuKHllYXIsIG1vbnRoLCBkYXkpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHN0YXRpYyBHZXRQcmV2TW9udGgoZGF0ZTogRGF0ZSk6IERhdGUge1xyXG4gICAgY29uc3QgdG1wID0gVGFtaW5QZXJzaWFuRGF0ZS50YW1pblBlcnNpYW5EYXRlLnRvSmFsYWFsaShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSArIDEsIGRhdGUuZ2V0RGF0ZSgpKTtcclxuICAgIGxldCBtb250aCA9IHRtcC5qbSAtIDE7XHJcbiAgICBsZXQgeWVhciA9IHRtcC5qeTtcclxuICAgIGxldCBkYXkgPSB0bXAuamQ7XHJcblxyXG4gICAgaWYgKG1vbnRoID09PSAwKSB7XHJcbiAgICAgIG1vbnRoID0gMTtcclxuICAgICAgeWVhciAtPSAxO1xyXG4gICAgfVxyXG4gICAgIGlmIChtb250aCA+IDYgJiYgZGF5ID4gMzApIHtcclxuICAgICAgIGRheSA9IDMwO1xyXG4gICAgIH1cclxuXHJcbiAgICBpZiAobW9udGggPT09IDEyICYmIFRhbWluUGVyc2lhbkRhdGUudGFtaW5QZXJzaWFuRGF0ZS5pc0xlYXBKYWxhYWxpWWVhcih5ZWFyKSAmJiBkYXkgPiAyOSkge1xyXG4gICAgICBkYXkgPSAyOTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gVGFtaW5QZXJzaWFuRGF0ZS5KYWxhbGlUb0dyZWdvcmlhbih5ZWFyLCBtb250aCwgZGF5KTtcclxuICB9XHJcblxyXG5cclxuICAvKlxyXG4gIENvbnZlcnRzIGEgR3JlZ29yaWFuIGRhdGUgdG8gSmFsYWFsaS5cclxuICAqL1xyXG4gIHB1YmxpYyB0b0phbGFhbGkoZ3ksIGdtLCBnZCkge1xyXG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChneSkgPT09ICdbb2JqZWN0IERhdGVdJykge1xyXG4gICAgICBnZCA9IGd5LmdldERhdGUoKTtcclxuICAgICAgZ20gPSBneS5nZXRNb250aCgpICsgMTtcclxuICAgICAgZ3kgPSBneS5nZXRGdWxsWWVhcigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuZDJqKHRoaXMuZzJkKGd5LCBnbSwgZ2QpKTtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICBDb252ZXJ0cyBhIEphbGFhbGkgZGF0ZSB0byBHcmVnb3JpYW4uXHJcbiAgKi9cclxuICBwdWJsaWMgdG9HcmVnb3JpYW4oanksIGptLCBqZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZDJnKHRoaXMuajJkKGp5LCBqbSwgamQpKTtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICBDaGVja3Mgd2hldGhlciBhIEphbGFhbGkgZGF0ZSBpcyB2YWxpZCBvciBub3QuXHJcbiAgKi9cclxuICBwdWJsaWMgaXNWYWxpZEphbGFhbGlEYXRlKGp5LCBqbSwgamQpIHtcclxuICAgIHJldHVybiBqeSA+PSAtNjEgJiYgankgPD0gMzE3NyAmJlxyXG4gICAgICBqbSA+PSAxICYmIGptIDw9IDEyICYmXHJcbiAgICAgIGpkID49IDEgJiYgamQgPD0gdGhpcy5qYWxhYWxpTW9udGhMZW5ndGgoanksIGptKTtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICBJcyB0aGlzIGEgbGVhcCB5ZWFyIG9yIG5vdD9cclxuICAqL1xyXG4gIHB1YmxpYyBpc0xlYXBKYWxhYWxpWWVhcihqeSkge1xyXG4gICAgcmV0dXJuIHRoaXMuamFsQ2FsTGVhcChqeSkgPT09IDA7XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gICAgTnVtYmVyIG9mIGRheXMgaW4gYSBnaXZlbiBtb250aCBpbiBhIEphbGFhbGkgeWVhci5cclxuICAqL1xyXG4gIHB1YmxpYyBqYWxhYWxpTW9udGhMZW5ndGgoanksIGptKSB7XHJcbiAgICBpZiAoam0gPD0gNikge1xyXG4gICAgICByZXR1cm4gMzE7XHJcbiAgICB9XHJcbiAgICBpZiAoam0gPD0gMTEpIHtcclxuICAgICAgcmV0dXJuIDMwO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuaXNMZWFwSmFsYWFsaVllYXIoankpKSB7XHJcbiAgICAgIHJldHVybiAzMDtcclxuICAgIH1cclxuICAgIHJldHVybiAyOTtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICAgIFRoaXMgZnVuY3Rpb24gZGV0ZXJtaW5lcyBpZiB0aGUgSmFsYWFsaSAoUGVyc2lhbikgeWVhciBpc1xyXG4gICAgICBsZWFwICgzNjYtZGF5IGxvbmcpIG9yIGlzIHRoZSBjb21tb24geWVhciAoMzY1IGRheXMpXHJcblxyXG4gICAgICBAcGFyYW0gankgSmFsYWFsaSBjYWxlbmRhciB5ZWFyICgtNjEgdG8gMzE3NylcclxuICAgICAgQHJldHVybnMgbnVtYmVyIG9mIHllYXJzIHNpbmNlIHRoZSBsYXN0IGxlYXAgeWVhciAoMCB0byA0KVxyXG4gICAqL1xyXG4gIHB1YmxpYyBqYWxDYWxMZWFwKGp5KSB7XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWNvbnN0XHJcbiAgICBsZXQgYmwgPSB0aGlzLmJyZWFrcy5sZW5ndGhcclxuICAgICAgLCBqcCA9IHRoaXMuYnJlYWtzWzBdXHJcbiAgICAgICwgam1cclxuICAgICAgLCBqdW1wXHJcbiAgICAgICwgbGVhcFxyXG4gICAgICAsIG5cclxuICAgICAgLCBpO1xyXG5cclxuICAgIGlmIChqeSA8IGpwIHx8IGp5ID49IHRoaXMuYnJlYWtzW2JsIC0gMV0pIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIEphbGFhbGkgeWVhciAnICsgankpO1xyXG4gICAgfVxyXG5cclxuICAgIGZvciAoaSA9IDE7IGkgPCBibDsgaSArPSAxKSB7XHJcbiAgICAgIGptID0gdGhpcy5icmVha3NbaV07XHJcbiAgICAgIGp1bXAgPSBqbSAtIGpwO1xyXG4gICAgICBpZiAoankgPCBqbSkge1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIGpwID0gam07XHJcbiAgICB9XHJcbiAgICBuID0gankgLSBqcDtcclxuXHJcbiAgICBpZiAoanVtcCAtIG4gPCA2KSB7XHJcbiAgICAgIG4gPSBuIC0ganVtcCArIHRoaXMuZGl2KGp1bXAgKyA0LCAzMykgKiAzMztcclxuICAgIH1cclxuICAgIGxlYXAgPSB0aGlzLm1vZCh0aGlzLm1vZChuICsgMSwgMzMpIC0gMSwgNCk7XHJcbiAgICBpZiAobGVhcCA9PT0gLTEpIHtcclxuICAgICAgbGVhcCA9IDQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGxlYXA7XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gICAgVGhpcyBmdW5jdGlvbiBkZXRlcm1pbmVzIGlmIHRoZSBKYWxhYWxpIChQZXJzaWFuKSB5ZWFyIGlzXHJcbiAgICBsZWFwICgzNjYtZGF5IGxvbmcpIG9yIGlzIHRoZSBjb21tb24geWVhciAoMzY1IGRheXMpLCBhbmRcclxuICAgIGZpbmRzIHRoZSBkYXkgaW4gTWFyY2ggKEdyZWdvcmlhbiBjYWxlbmRhcikgb2YgdGhlIGZpcnN0XHJcbiAgICBkYXkgb2YgdGhlIEphbGFhbGkgeWVhciAoankpLlxyXG5cclxuICAgIEBwYXJhbSBqeSBKYWxhYWxpIGNhbGVuZGFyIHllYXIgKC02MSB0byAzMTc3KVxyXG4gICAgQHBhcmFtIHdpdGhvdXRMZWFwIHdoZW4gZG9uJ3QgbmVlZCBsZWFwICh0cnVlIG9yIGZhbHNlKSBkZWZhdWx0IGlzIGZhbHNlXHJcbiAgICBAcmV0dXJuXHJcbiAgICAgIGxlYXA6IG51bWJlciBvZiB5ZWFycyBzaW5jZSB0aGUgbGFzdCBsZWFwIHllYXIgKDAgdG8gNClcclxuICAgICAgZ3k6IEdyZWdvcmlhbiB5ZWFyIG9mIHRoZSBiZWdpbm5pbmcgb2YgSmFsYWFsaSB5ZWFyXHJcbiAgICAgIG1hcmNoOiB0aGUgTWFyY2ggZGF5IG9mIEZhcnZhcmRpbiB0aGUgMXN0ICgxc3QgZGF5IG9mIGp5KVxyXG4gICAgQHNlZTogaHR0cDovL3d3dy5hc3Ryby51bmkudG9ydW4ucGwvfmtiL1BhcGVycy9FTVAvUGVyc2lhbkMtRU1QLmh0bVxyXG4gICAgQHNlZTogaHR0cDovL3d3dy5mb3VybWlsYWIuY2gvZG9jdW1lbnRzL2NhbGVuZGFyL1xyXG4gICovXHJcbiAgcHVibGljIGphbENhbChqeSwgd2l0aG91dExlYXApIHtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItY29uc3RcclxuICAgIGxldCBibCA9IHRoaXMuYnJlYWtzLmxlbmd0aFxyXG4gICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWNvbnN0XHJcbiAgICAgICwgZ3kgPSBqeSArIDYyMVxyXG4gICAgICAsIGxlYXBKID0gLTE0XHJcbiAgICAgICwganAgPSB0aGlzLmJyZWFrc1swXVxyXG4gICAgICAsIGptXHJcbiAgICAgICwganVtcFxyXG4gICAgICAsIGxlYXBcclxuICAgICAgLCBsZWFwR1xyXG4gICAgICAsIG1hcmNoXHJcbiAgICAgICwgblxyXG4gICAgICAsIGk7XHJcblxyXG4gICAgaWYgKGp5IDwganAgfHwgankgPj0gdGhpcy5icmVha3NbYmwgLSAxXSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgSmFsYWFsaSB5ZWFyICcgKyBqeSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmluZCB0aGUgbGltaXRpbmcgeWVhcnMgZm9yIHRoZSBKYWxhYWxpIHllYXIgankuXHJcbiAgICBmb3IgKGkgPSAxOyBpIDwgYmw7IGkgKz0gMSkge1xyXG4gICAgICBqbSA9IHRoaXMuYnJlYWtzW2ldO1xyXG4gICAgICBqdW1wID0gam0gLSBqcDtcclxuICAgICAgaWYgKGp5IDwgam0pIHtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBsZWFwSiA9IGxlYXBKICsgdGhpcy5kaXYoanVtcCwgMzMpICogOCArIHRoaXMuZGl2KHRoaXMubW9kKGp1bXAsIDMzKSwgNCk7XHJcbiAgICAgIGpwID0gam07XHJcbiAgICB9XHJcbiAgICBuID0gankgLSBqcDtcclxuXHJcbiAgICAvLyBGaW5kIHRoZSBudW1iZXIgb2YgbGVhcCB5ZWFycyBmcm9tIEFEIDYyMSB0byB0aGUgYmVnaW5uaW5nXHJcbiAgICAvLyBvZiB0aGUgY3VycmVudCBKYWxhYWxpIHllYXIgaW4gdGhlIFBlcnNpYW4gY2FsZW5kYXIuXHJcbiAgICBsZWFwSiA9IGxlYXBKICsgdGhpcy5kaXYobiwgMzMpICogOCArIHRoaXMuZGl2KHRoaXMubW9kKG4sIDMzKSArIDMsIDQpO1xyXG4gICAgaWYgKHRoaXMubW9kKGp1bXAsIDMzKSA9PT0gNCAmJiBqdW1wIC0gbiA9PT0gNCkge1xyXG4gICAgICBsZWFwSiArPSAxO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFuZCB0aGUgc2FtZSBpbiB0aGUgR3JlZ29yaWFuIGNhbGVuZGFyICh1bnRpbCB0aGUgeWVhciBneSkuXHJcbiAgICBsZWFwRyA9IHRoaXMuZGl2KGd5LCA0KSAtIHRoaXMuZGl2KCh0aGlzLmRpdihneSwgMTAwKSArIDEpICogMywgNCkgLSAxNTA7XHJcblxyXG4gICAgLy8gRGV0ZXJtaW5lIHRoZSBHcmVnb3JpYW4gZGF0ZSBvZiBGYXJ2YXJkaW4gdGhlIDFzdC5cclxuICAgIG1hcmNoID0gMjAgKyBsZWFwSiAtIGxlYXBHO1xyXG5cclxuICAgIC8vIHJldHVybiB3aXRoIGd5IGFuZCBtYXJjaCB3aGVuIHdlIGRvbid0IG5lZWQgbGVhcFxyXG4gICAgaWYgKHdpdGhvdXRMZWFwKSB7XHJcbiAgICAgIHJldHVybiB7Z3k6IGd5LCBtYXJjaDogbWFyY2h9O1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyBGaW5kIGhvdyBtYW55IHllYXJzIGhhdmUgcGFzc2VkIHNpbmNlIHRoZSBsYXN0IGxlYXAgeWVhci5cclxuICAgIGlmIChqdW1wIC0gbiA8IDYpIHtcclxuICAgICAgbiA9IG4gLSBqdW1wICsgdGhpcy5kaXYoanVtcCArIDQsIDMzKSAqIDMzO1xyXG4gICAgfVxyXG4gICAgbGVhcCA9IHRoaXMubW9kKHRoaXMubW9kKG4gKyAxLCAzMykgLSAxLCA0KTtcclxuICAgIGlmIChsZWFwID09PSAtMSkge1xyXG4gICAgICBsZWFwID0gNDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsZWFwOiBsZWFwXHJcbiAgICAgICwgZ3k6IGd5XHJcbiAgICAgICwgbWFyY2g6IG1hcmNoXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLypcclxuICAgIENvbnZlcnRzIGEgZGF0ZSBvZiB0aGUgSmFsYWFsaSBjYWxlbmRhciB0byB0aGUgSnVsaWFuIERheSBudW1iZXIuXHJcblxyXG4gICAgQHBhcmFtIGp5IEphbGFhbGkgeWVhciAoMSB0byAzMTAwKVxyXG4gICAgQHBhcmFtIGptIEphbGFhbGkgbW9udGggKDEgdG8gMTIpXHJcbiAgICBAcGFyYW0gamQgSmFsYWFsaSBkYXkgKDEgdG8gMjkvMzEpXHJcbiAgICBAcmV0dXJuIEp1bGlhbiBEYXkgbnVtYmVyXHJcbiAgKi9cclxuICBwdWJsaWMgajJkKGp5LCBqbSwgamQpIHtcclxuICAgIGNvbnN0IHIgPSB0aGlzLmphbENhbChqeSwgdHJ1ZSk7XHJcbiAgICByZXR1cm4gdGhpcy5nMmQoci5neSwgMywgci5tYXJjaCkgKyAoam0gLSAxKSAqIDMxIC0gdGhpcy5kaXYoam0sIDcpICogKGptIC0gNykgKyBqZCAtIDE7XHJcbiAgfVxyXG5cclxuICAvKlxyXG4gICAgQ29udmVydHMgdGhlIEp1bGlhbiBEYXkgbnVtYmVyIHRvIGEgZGF0ZSBpbiB0aGUgSmFsYWFsaSBjYWxlbmRhci5cclxuXHJcbiAgICBAcGFyYW0gamRuIEp1bGlhbiBEYXkgbnVtYmVyXHJcbiAgICBAcmV0dXJuXHJcbiAgICAgIGp5OiBKYWxhYWxpIHllYXIgKDEgdG8gMzEwMClcclxuICAgICAgam06IEphbGFhbGkgbW9udGggKDEgdG8gMTIpXHJcbiAgICAgIGpkOiBKYWxhYWxpIGRheSAoMSB0byAyOS8zMSlcclxuICAqL1xyXG4gIHB1YmxpYyBkMmooamRuKSB7XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6cHJlZmVyLWNvbnN0XHJcbiAgICBsZXQgZ3kgPSB0aGlzLmQyZyhqZG4pLmd5IC8vIENhbGN1bGF0ZSBHcmVnb3JpYW4geWVhciAoZ3kpLlxyXG4gICAgICAsIGp5ID0gZ3kgLSA2MjFcclxuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnByZWZlci1jb25zdFxyXG4gICAgICAsIHIgPSB0aGlzLmphbENhbChqeSwgZmFsc2UpXHJcbiAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItY29uc3RcclxuICAgICAgLCBqZG4xZiA9IHRoaXMuZzJkKGd5LCAzLCByLm1hcmNoKVxyXG4gICAgICAsIGpkXHJcbiAgICAgICwgam1cclxuICAgICAgLCBrO1xyXG5cclxuICAgIC8vIEZpbmQgbnVtYmVyIG9mIGRheXMgdGhhdCBwYXNzZWQgc2luY2UgMSBGYXJ2YXJkaW4uXHJcbiAgICBrID0gamRuIC0gamRuMWY7XHJcbiAgICBpZiAoayA+PSAwKSB7XHJcbiAgICAgIGlmIChrIDw9IDE4NSkge1xyXG4gICAgICAgIC8vIFRoZSBmaXJzdCA2IG1vbnRocy5cclxuICAgICAgICBqbSA9IDEgKyB0aGlzLmRpdihrLCAzMSk7XHJcbiAgICAgICAgamQgPSB0aGlzLm1vZChrLCAzMSkgKyAxO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBqeToganlcclxuICAgICAgICAgICwgam06IGptXHJcbiAgICAgICAgICAsIGpkOiBqZFxyXG4gICAgICAgIH07XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gVGhlIHJlbWFpbmluZyBtb250aHMuXHJcbiAgICAgICAgayAtPSAxODY7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIFByZXZpb3VzIEphbGFhbGkgeWVhci5cclxuICAgICAgankgLT0gMTtcclxuICAgICAgayArPSAxNzk7XHJcbiAgICAgIGlmIChyLmxlYXAgPT09IDEpIHtcclxuICAgICAgICBrICs9IDE7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGptID0gNyArIHRoaXMuZGl2KGssIDMwKTtcclxuICAgIGpkID0gdGhpcy5tb2QoaywgMzApICsgMTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGp5OiBqeVxyXG4gICAgICAsIGptOiBqbVxyXG4gICAgICAsIGpkOiBqZFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICBDYWxjdWxhdGVzIHRoZSBKdWxpYW4gRGF5IG51bWJlciBmcm9tIEdyZWdvcmlhbiBvciBKdWxpYW5cclxuICAgIGNhbGVuZGFyIGRhdGVzLiBUaGlzIGludGVnZXIgbnVtYmVyIGNvcnJlc3BvbmRzIHRvIHRoZSBub29uIG9mXHJcbiAgICB0aGUgZGF0ZSAoaS5lLiAxMiBob3VycyBvZiBVbml2ZXJzYWwgVGltZSkuXHJcbiAgICBUaGUgcHJvY2VkdXJlIHdhcyB0ZXN0ZWQgdG8gYmUgZ29vZCBzaW5jZSAxIE1hcmNoLCAtMTAwMTAwIChvZiBib3RoXHJcbiAgICBjYWxlbmRhcnMpIHVwIHRvIGEgZmV3IG1pbGxpb24geWVhcnMgaW50byB0aGUgZnV0dXJlLlxyXG5cclxuICAgIEBwYXJhbSBneSBDYWxlbmRhciB5ZWFyICh5ZWFycyBCQyBudW1iZXJlZCAwLCAtMSwgLTIsIC4uLilcclxuICAgIEBwYXJhbSBnbSBDYWxlbmRhciBtb250aCAoMSB0byAxMilcclxuICAgIEBwYXJhbSBnZCBDYWxlbmRhciBkYXkgb2YgdGhlIG1vbnRoICgxIHRvIDI4LzI5LzMwLzMxKVxyXG4gICAgQHJldHVybiBKdWxpYW4gRGF5IG51bWJlclxyXG4gICovXHJcbiAgcHVibGljIGcyZChneSwgZ20sIGdkKSB7XHJcbiAgICBsZXQgZCA9IHRoaXMuZGl2KChneSArIHRoaXMuZGl2KGdtIC0gOCwgNikgKyAxMDAxMDApICogMTQ2MSwgNClcclxuICAgICAgKyB0aGlzLmRpdigxNTMgKiB0aGlzLm1vZChnbSArIDksIDEyKSArIDIsIDUpXHJcbiAgICAgICsgZ2QgLSAzNDg0MDQwODtcclxuICAgIGQgPSBkIC0gdGhpcy5kaXYodGhpcy5kaXYoZ3kgKyAxMDAxMDAgKyB0aGlzLmRpdihnbSAtIDgsIDYpLCAxMDApICogMywgNCkgKyA3NTI7XHJcbiAgICByZXR1cm4gZDtcclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICBDYWxjdWxhdGVzIEdyZWdvcmlhbiBhbmQgSnVsaWFuIGNhbGVuZGFyIGRhdGVzIGZyb20gdGhlIEp1bGlhbiBEYXkgbnVtYmVyXHJcbiAgICAoamRuKSBmb3IgdGhlIHBlcmlvZCBzaW5jZSBqZG49LTM0ODM5NjU1IChpLmUuIHRoZSB5ZWFyIC0xMDAxMDAgb2YgYm90aFxyXG4gICAgY2FsZW5kYXJzKSB0byBzb21lIG1pbGxpb25zIHllYXJzIGFoZWFkIG9mIHRoZSBwcmVzZW50LlxyXG5cclxuICAgIEBwYXJhbSBqZG4gSnVsaWFuIERheSBudW1iZXJcclxuICAgIEByZXR1cm5cclxuICAgICAgZ3k6IENhbGVuZGFyIHllYXIgKHllYXJzIEJDIG51bWJlcmVkIDAsIC0xLCAtMiwgLi4uKVxyXG4gICAgICBnbTogQ2FsZW5kYXIgbW9udGggKDEgdG8gMTIpXHJcbiAgICAgIGdkOiBDYWxlbmRhciBkYXkgb2YgdGhlIG1vbnRoIE0gKDEgdG8gMjgvMjkvMzAvMzEpXHJcbiAgKi9cclxuICBwdWJsaWMgZDJnKGpkbikge1xyXG4gICAgbGV0IGpcclxuICAgICAgLCBpXHJcbiAgICAgICwgZ2RcclxuICAgICAgLCBnbVxyXG4gICAgICAsIGd5O1xyXG4gICAgaiA9IDQgKiBqZG4gKyAxMzkzNjE2MzE7XHJcbiAgICBqID0gaiArIHRoaXMuZGl2KHRoaXMuZGl2KDQgKiBqZG4gKyAxODMxODc3MjAsIDE0NjA5NykgKiAzLCA0KSAqIDQgLSAzOTA4O1xyXG4gICAgaSA9IHRoaXMuZGl2KHRoaXMubW9kKGosIDE0NjEpLCA0KSAqIDUgKyAzMDg7XHJcbiAgICBnZCA9IHRoaXMuZGl2KHRoaXMubW9kKGksIDE1MyksIDUpICsgMTtcclxuICAgIGdtID0gdGhpcy5tb2QodGhpcy5kaXYoaSwgMTUzKSwgMTIpICsgMTtcclxuICAgIGd5ID0gdGhpcy5kaXYoaiwgMTQ2MSkgLSAxMDAxMDAgKyB0aGlzLmRpdig4IC0gZ20sIDYpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZ3k6IGd5XHJcbiAgICAgICwgZ206IGdtXHJcbiAgICAgICwgZ2Q6IGdkXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLypcclxuICAgIFV0aWxpdHkgaGVscGVyIGZ1bmN0aW9ucy5cclxuICAqL1xyXG4gIHB1YmxpYyBkaXYoYSwgYikge1xyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWJpdHdpc2VcclxuICAgIHJldHVybiB+fihhIC8gYik7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgbW9kKGEsIGIpIHtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1iaXR3aXNlXHJcbiAgICByZXR1cm4gYSAtIH5+KGEgLyBiKSAqIGI7XHJcbiAgfVxyXG59XHJcbiJdfQ==