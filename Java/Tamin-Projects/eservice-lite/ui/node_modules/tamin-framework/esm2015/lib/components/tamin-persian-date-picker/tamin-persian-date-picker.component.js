/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Input, Output } from '@angular/core';
export class TaminPersianDatePickerComponent {
    constructor() {
        this.dayData = [];
        this.yearData = [];
        this.monthData = [];
        this.dateChanged = new EventEmitter();
        this.cancel = new EventEmitter();
    }
    /**
     * @param {?} date
     * @return {?}
     */
    set currentDate(date) {
        if (date !== undefined && date !== null) {
            this._currentDate = date;
            this.generateDayData();
        }
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.onChangeView('DayPicker');
    }
    /**
     * @return {?}
     */
    get currentDate() {
        return this._currentDate;
    }
    /**
     * @return {?}
     */
    get currentMonthName() {
        // return moment(this.currentDate).locale('fa').format('MMMM');
        return (new persianDate(this.currentDate)).format('MMMM');
    }
    /**
     * @return {?}
     */
    get currentYear() {
        // return moment(this.currentDate).jYear();
        return (new persianDate(this.currentDate)).year();
    }
    /**
     * @return {?}
     */
    generateDayData() {
        this.dayData = [];
        // const today = moment(this.currentDate !== undefined ? this.currentDate : new Date());
        /** @type {?} */
        const today = new persianDate(this.currentDate !== undefined ? this.currentDate : new Date());
        // const currentMonth = today.jMonth() + 1;
        /** @type {?} */
        const currentMonth = today.month();
        // const currentDay = today.jDate();
        /** @type {?} */
        const currentDay = today.date();
        // const firstDayInMonth = today.startOf('jMonth');
        /** @type {?} */
        const firstDayInMonth = today.startOf('month');
        // const firstElementInGrid = firstDayInMonth.subtract(firstDayInMonth.jDay(), 'day');
        /** @type {?} */
        const firstElementInGrid = firstDayInMonth.subtract('days', firstDayInMonth.day());
        /** @type {?} */
        const data = [];
        for (let i = 0; i < 42; i++) {
            /** @type {?} */
            const tmp = firstElementInGrid.clone().add(i, 'd').hour(23);
            data.push({
                year: tmp.year(),
                month: tmp.month(),
                day: tmp.date(),
                persianDay: tmp.date(),
                today: (tmp.month() === currentMonth) && (tmp.date() === currentDay),
                date: tmp.toDate(),
                nextPrevMonth: tmp.month() !== currentMonth
            });
        }
        this.dayData = data;
    }
    /**
     * @param {?} startYear
     * @return {?}
     */
    generateYearData(startYear) {
        /** @type {?} */
        const today = new persianDate(this.currentDate);
        /** @type {?} */
        const currentYear = today.year();
        this.yearData = [];
        /** @type {?} */
        const year = startYear;
        /** @type {?} */
        const data = [];
        for (let i = 0; i < 20; i++) {
            data.push({
                year: year + i,
                currentYear: currentYear === (year + i)
            });
        }
        this.yearData = data;
    }
    /**
     * @return {?}
     */
    generateMonthData() {
        /** @type {?} */
        const tmp = new persianDate(this.currentDate);
        /** @type {?} */
        const currentMonth = tmp.month();
        this.monthData = [
            {
                name: 'فروردین',
                month: 1,
                currentMonth: currentMonth === 1
            },
            {
                name: 'اردیبهشت',
                month: 2,
                currentMonth: currentMonth === 2
            },
            {
                name: 'خرداد',
                month: 3,
                currentMonth: currentMonth === 3
            },
            {
                name: 'تیر',
                month: 4,
                currentMonth: currentMonth === 4
            },
            {
                name: 'مرداد',
                month: 5,
                currentMonth: currentMonth === 5
            },
            {
                name: 'شهریور',
                month: 6,
                currentMonth: currentMonth === 6
            },
            {
                name: 'مهر',
                month: 7,
                currentMonth: currentMonth === 7
            },
            {
                name: 'آبان',
                month: 8,
                currentMonth: currentMonth === 8
            },
            {
                name: 'آذر',
                month: 9,
                currentMonth: currentMonth === 9
            },
            {
                name: 'دی',
                month: 10,
                currentMonth: currentMonth === 10
            }, {
                name: 'بهمن',
                month: 11,
                currentMonth: currentMonth === 11
            },
            {
                name: 'اسفند',
                month: 12,
                currentMonth: currentMonth === 12
            }
        ];
    }
    /**
     * @return {?}
     */
    hide() {
        this.cancel.emit();
    }
    /**
     * @return {?}
     */
    onPrevMonth() {
        /** @type {?} */
        let today = new persianDate(this.currentDate);
        today = today.subtract('months', 1);
        today.date(1);
        this.currentDate = today.toDate();
        this.generateDayData();
    }
    /**
     * @return {?}
     */
    onNextMonth() {
        /** @type {?} */
        let today = new persianDate(this.currentDate);
        today = today.add('months', 1);
        today.date(1);
        this.currentDate = today.toDate();
        this.generateDayData();
    }
    /**
     * @return {?}
     */
    onToday() {
        this.currentDate = new Date();
        this.generateDayData();
        this.dateChanged.emit(this._currentDate);
    }
    /**
     * @param {?} date
     * @return {?}
     */
    onSetDay(date) {
        this.currentDate = new Date(date);
        this.generateDayData();
        this.dateChanged.emit(this._currentDate);
    }
    /**
     * @return {?}
     */
    setView() {
        this.viewState = 'DayPicker';
    }
    /**
     * @param {?} viewName
     * @return {?}
     */
    onChangeView(viewName) {
        setTimeout((/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const today = new persianDate(this.currentDate);
            switch (viewName) {
                case 'YearPicker':
                    this.viewState = 'YearPicker';
                    this.generateYearData(today.year());
                    break;
                case 'MonthPicker':
                    this.viewState = 'MonthPicker';
                    this.generateMonthData();
                    break;
                case 'DayPicker':
                    this.viewState = 'DayPicker';
                    this.generateDayData();
                    break;
            }
        }));
    }
    /**
     * @return {?}
     */
    onPrevYearGroup() {
        /** @type {?} */
        const startYear = this.yearData[0].year - 20;
        this.generateYearData(startYear);
    }
    /**
     * @return {?}
     */
    onNextYearGroup() {
        /** @type {?} */
        const startYear = this.yearData[0].year + 20;
        this.generateYearData(startYear);
    }
    /**
     * @return {?}
     */
    onThisYear() {
        this.currentDate = new Date();
        this.onChangeView('DayPicker');
    }
    /**
     * @return {?}
     */
    onThisMonth() {
        this.currentDate = new Date();
        this.onChangeView('DayPicker');
    }
    /**
     * @param {?} year
     * @return {?}
     */
    onSetYear(year) {
        // const tmp = moment(this.currentDate);
        /** @type {?} */
        const tmp = new persianDate(this.currentDate);
        tmp.year(year);
        this.currentDate = tmp.toDate();
        this.onChangeView('DayPicker');
    }
    /**
     * @param {?} month
     * @return {?}
     */
    onSetMonth(month) {
        // const tmp = moment(this.currentDate);
        /** @type {?} */
        const tmp = new persianDate(this.currentDate);
        tmp.month(month);
        this.currentDate = tmp.toDate();
        this.onChangeView('DayPicker');
    }
}
TaminPersianDatePickerComponent.decorators = [
    { type: Component, args: [{
                selector: 'tamin-persian-date-picker',
                template: "<div class=\"calendar-container\">\r\n  <!-- Day picker -->\r\n  <div class=\"day-picker-view\" *ngIf=\"viewState === 'DayPicker'\">\r\n    <div class=\"calendar-header\">\r\n      <div class=\"calendar-header-prev\" title=\"\u0645\u0627\u0647 \u0642\u0628\u0644\u06CC\">\r\n        <a (click)=\"onPrevMonth()\" class=\"button-effect\"><i class=\"icon-fast-fw\"></i></a></div>\r\n      <div class=\"calendar-header-title\">\r\n        <a class=\"button-effect\" (click)=\"onChangeView('MonthPicker')\" title=\"\u0627\u0646\u062A\u062E\u0627\u0628 \u0645\u0627\u0647\">{{currentMonthName}}</a>\r\n        <span style=\"padding-left: 5px\"></span>\r\n        <a class=\"button-effect\" (click)=\"onChangeView('YearPicker')\" title=\"\u0627\u0646\u062A\u062E\u0627\u0628 \u0633\u0627\u0644\">{{currentYear | persianNumber}}</a>\r\n      </div>\r\n      <div class=\"calendar-header-next\" title=\"\u0645\u0627\u0647 \u0628\u0639\u062F\u06CC\">\r\n        <a (click)=\"onNextMonth()\" class=\"button-effect\"><i class=\"icon-rewind\"></i></a>\r\n      </div>\r\n    </div>\r\n    <div class=\"calendar-body day-picker-view\">\r\n      <div class=\"day-names\">\r\n        <div class=\"\">\u0634</div>\r\n        <div class=\"\">\u06CC</div>\r\n        <div class=\"\">\u062F</div>\r\n        <div class=\"\">\u0633</div>\r\n        <div class=\"\">\u0686</div>\r\n        <div class=\"\">\u067E</div>\r\n        <div class=\"\">\u062C</div>\r\n      </div>\r\n      <ng-container *ngFor=\"let day of dayData\">\r\n        <div class=\"day-picker-day\" (click)=\"onSetDay(day.date)\"\r\n             [ngClass]=\"{'day-picker-day-not-current-month': day.nextPrevMonth, 'day-picker-day-today':day.today}\">\r\n          {{day.day}}\r\n        </div>\r\n      </ng-container>\r\n    </div>\r\n    <div class=\"calendar-footer\">\r\n      <a (click)=\"onToday()\" class=\"button-effect\">\u0627\u0645\u0631\u0648\u0632</a> <span style=\"padding-left: 15px\"></span>\r\n      <a (click)=\"hide()\" class=\"button-effect\">\u0627\u0646\u0635\u0631\u0627\u0641</a>\r\n    </div>\r\n  </div>\r\n  <!-- Month picker -->\r\n  <div *ngIf=\"viewState === 'MonthPicker'\">\r\n    <div class=\"calendar-header\"></div>\r\n    <div class=\"calendar-body month-picker-view\">\r\n      <ng-container *ngFor=\"let month of monthData\">\r\n        <div class=\"month-picker-view-month\" [ngClass]=\"{'current-month':month.currentMonth}\"\r\n             (click)=\"onSetMonth(month.month)\">{{month.name}}\r\n        </div>\r\n      </ng-container>\r\n    </div>\r\n    <div class=\"day-picker-tomonth\">\r\n      <a (click)=\"onThisMonth()\" class=\"button-effect\">\u0645\u0627\u0647 \u062C\u0627\u0631\u06CC</a>\r\n    </div>\r\n  </div>\r\n  <!-- Year picker -->\r\n  <div *ngIf=\"viewState === 'YearPicker'\" class=\"\">\r\n    <div class=\"calendar-header\">\r\n      <div class=\"calendar-header-prev\" >\r\n        <a (click)=\"onPrevYearGroup()\" class=\"button-effect\"><i class=\"icon-fast-fw\"></i></a></div>\r\n      <div class=\"calendar-header-title\">\r\n        {{yearData[19].year | persianNumber}} - {{yearData[0].year | persianNumber}}\r\n      </div>\r\n      <div class=\"calendar-header-next\">\r\n        <a (click)=\"onNextYearGroup()\" class=\"button-effect\" style=\"color: white\"><i class=\"icon-rewind\"></i></a>\r\n      </div>\r\n    </div>\r\n    <div class=\"calendar-body year-picker-view\">\r\n      <ng-container *ngFor=\"let year of yearData\">\r\n        <div class=\"year-picker-view-year\" [ngClass]=\"{'current-year':year.currentYear}\" (click)=\"onSetYear(year.year)\">\r\n          {{year.year | persianNumber}}\r\n        </div>\r\n      </ng-container>\r\n    </div>\r\n    <div class=\"calendar-footer\">\r\n      <a (click)=\"onThisYear()\" class=\"button-effect\">\u0627\u0645\u0633\u0627\u0644</a>\r\n    </div>\r\n  </div>\r\n</div>\r\n",
                styles: [".calendar-container{background-color:#fff;width:197px;height:290px;border:1px solid #6c63fe}.calendar-header{width:100%!important;height:40px;padding:10px;background-color:#6c63fe;display:flex;margin:0}.calendar-header-next{width:10%;margin-right:-4px}.calendar-header-next a{text-decoration:none;color:#fff}.calendar-header-prev{width:10%}.calendar-header-prev a{text-decoration:none;color:#fff}.calendar-header-title{width:80%;text-align:center;color:#fff}.calendar-header-title a{text-decoration:none;color:#fff}.calendar-body{width:100%!important;height:208px}.calendar-footer{width:100%!important;height:40px;padding:10px;background-color:#6c63fe;display:flex;justify-content:center;align-items:center}.calendar-footer a{color:#fff;text-decoration:none}.day-names,.day-picker-view{display:flex;flex-wrap:wrap}.day-names div{margin-right:6px;margin-top:3px;width:21px;display:flex;justify-content:center;color:#999;font-weight:700}.day-picker-day{margin-right:6px;width:21px;height:21px;display:flex;justify-content:center;cursor:pointer}.day-picker-day-today{background-color:#6c63fe;border-radius:20%;color:#fff}.day-picker-day-not-current-month{color:#999}.day-picker-day:hover{background-color:#e5e5fa;color:#000;border-radius:20%}.day-picker-today{margin-top:5px;width:100%!important;height:25px;padding:5px;background-color:#6c63fe;display:flex;justify-content:center;align-items:center;border-radius:20%}.day-picker-today a{color:#fff;text-decoration:none}.month-picker-view{display:flex;flex-wrap:wrap}.month-picker-view-month{margin-right:6px;margin-top:10px;width:55px;height:30px;display:flex;justify-content:center;align-items:center;cursor:pointer}.month-picker-view-month:hover{background-color:#6c63fe;color:#fff}.day-picker-tomonth{margin-top:5px;width:100%!important;height:35px;padding:5px;background-color:#6c63fe;display:flex;justify-content:center;align-items:center}.day-picker-tomonth a{text-decoration:none;color:#fff}.current-month,.current-year{background-color:#6c63fe;color:#fff}.year-picker-view{display:flex;flex-wrap:wrap}.year-picker-view-year{margin-right:6px;margin-top:10px;width:40px;height:29px;display:flex;justify-content:center;align-items:center;cursor:pointer}.year-picker-view-year:hover{background-color:#6c63fe;color:#fff}.year-picker-toyear{margin-top:5px;width:100%!important;height:30px;padding:5px;background-color:#6c63fe;display:flex;justify-content:center;align-items:center}.year-picker-toyear a{color:#fff;text-decoration:none}.year-picker-header-year-ranage{width:80%;text-align:center}.button-effect{cursor:pointer;padding-left:3px;padding-right:3px}.button-effect:hover{background-color:#fff;color:#0081dc!important}"]
            }] }
];
/** @nocollapse */
TaminPersianDatePickerComponent.ctorParameters = () => [];
TaminPersianDatePickerComponent.propDecorators = {
    dateChanged: [{ type: Output }],
    cancel: [{ type: Output }],
    currentDate: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    TaminPersianDatePickerComponent.prototype.dayData;
    /** @type {?} */
    TaminPersianDatePickerComponent.prototype.yearData;
    /** @type {?} */
    TaminPersianDatePickerComponent.prototype.monthData;
    /** @type {?} */
    TaminPersianDatePickerComponent.prototype.viewState;
    /**
     * @type {?}
     * @private
     */
    TaminPersianDatePickerComponent.prototype._currentDate;
    /** @type {?} */
    TaminPersianDatePickerComponent.prototype.dateChanged;
    /** @type {?} */
    TaminPersianDatePickerComponent.prototype.cancel;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFtaW4tcGVyc2lhbi1kYXRlLXBpY2tlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly90YW1pbi1mcmFtZXdvcmsvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90YW1pbi1wZXJzaWFuLWRhdGUtcGlja2VyL3RhbWluLXBlcnNpYW4tZGF0ZS1waWNrZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQVUsTUFBTSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBWTdFLE1BQU0sT0FBTywrQkFBK0I7SUFnQjFDO1FBZkEsWUFBTyxHQUFHLEVBQUUsQ0FBQztRQUNiLGFBQVEsR0FBRyxFQUFFLENBQUM7UUFDZCxjQUFTLEdBQUcsRUFBRSxDQUFDO1FBR0wsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBUSxDQUFDO1FBQ3ZDLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBUSxDQUFDO0lBVTVDLENBQUM7Ozs7O0lBUkQsSUFBYSxXQUFXLENBQUMsSUFBVTtRQUNqQyxJQUFJLElBQUksS0FBSyxTQUFTLElBQUksSUFBSSxLQUFLLElBQUksRUFBRTtZQUN2QyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQztZQUN6QixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7U0FDeEI7SUFDSCxDQUFDOzs7O0lBS0QsUUFBUTtRQUNOLElBQUksQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7OztJQUVELElBQUksV0FBVztRQUNiLE9BQU8sSUFBSSxDQUFDLFlBQVksQ0FBQztJQUMzQixDQUFDOzs7O0lBRUQsSUFBSSxnQkFBZ0I7UUFDbEIsK0RBQStEO1FBQy9ELE9BQU8sQ0FBQyxJQUFJLFdBQVcsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDNUQsQ0FBQzs7OztJQUVE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UixZQUFZLEVBQUUsWUFBWSxLQUFLLENBQUM7YUFDakM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsT0FBTztnQkFDYixLQUFLLEVBQUUsQ0FBQztnQkFDUixZQUFZLEVBQUUsWUFBWSxLQUFLLENBQUM7YUFDakM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsS0FBSztnQkFDWCxLQUFLLEVBQUUsQ0FBQztnQkFDUixZQUFZLEVBQUUsWUFBWSxLQUFLLENBQUM7YUFDakM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsT0FBTztnQkFDYixLQUFLLEVBQUUsQ0FBQztnQkFDUixZQUFZLEVBQUUsWUFBWSxLQUFLLENBQUM7YUFDakM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsUUFBUTtnQkFDZCxLQUFLLEVBQUUsQ0FBQztnQkFDUixZQUFZLEVBQUUsWUFBWSxLQUFLLENBQUM7YUFDakM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsS0FBSztnQkFDWCxLQUFLLEVBQUUsQ0FBQztnQkFDUixZQUFZLEVBQUUsWUFBWSxLQUFLLENBQUM7YUFDakM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsTUFBTTtnQkFDWixLQUFLLEVBQUUsQ0FBQztnQkFDUixZQUFZLEVBQUUsWUFBWSxLQUFLLENBQUM7YUFDakM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsS0FBSztnQkFDWCxLQUFLLEVBQUUsQ0FBQztnQkFDUixZQUFZLEVBQUUsWUFBWSxLQUFLLENBQUM7YUFDakM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsSUFBSTtnQkFDVixLQUFLLEVBQUUsRUFBRTtnQkFDVCxZQUFZLEVBQUUsWUFBWSxLQUFLLEVBQUU7YUFDbEMsRUFBRTtnQkFDRCxJQUFJLEVBQUUsTUFBTTtnQkFDWixLQUFLLEVBQUUsRUFBRTtnQkFDVCxZQUFZLEVBQUUsWUFBWSxLQUFLLEVBQUU7YUFDbEM7WUFDRDtnQkFDRSxJQUFJLEVBQUUsT0FBTztnQkFDYixLQUFLLEVBQUUsRUFBRTtnQkFDVCxZQUFZLEVBQUUsWUFBWSxLQUFLLEVBQUU7YUFDbEM7U0FDRixDQUFDO0lBQ0osQ0FBQzs7OztJQUVE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QUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7Ozs7SUFFRCxXQUFXO1FBQ1QsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLElBQUksRUFBRSxDQUFDO1FBQzlCLElBQUksQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7SUFFRCxTQUFTLENBQUMsSUFBSTs7O2NBRU4sR0FBRyxHQUFHLElBQUksV0FBVyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDN0MsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNmLElBQUksQ0FBQyxXQUFXLEdBQUcsR0FBRyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7SUFFRCxVQUFVLENBQUMsS0FBSzs7O2NBRVIsR0FBRyxHQUFHLElBQUksV0FBVyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDN0MsR0FBRyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNqQixJQUFJLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNoQyxJQUFJLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2pDLENBQUM7OztZQW5QRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLDJCQUEyQjtnQkFDckMsa3lIQUF5RDs7YUFFMUQ7Ozs7OzBCQU9FLE1BQU07cUJBQ04sTUFBTTswQkFFTixLQUFLOzs7O0lBUk4sa0RBQWE7O0lBQ2IsbURBQWM7O0lBQ2Qsb0RBQWU7O0lBQ2Ysb0RBQWtCOzs7OztJQUNsQix1REFBMkI7O0lBQzNCLHNEQUFpRDs7SUFDakQsaURBQTRDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcbi8vIGltcG9ydCAqIGFzIG1vbWVudE5zIGZyb20gJ2phbGFsaS1tb21lbnQnO1xuXG4vLyBjb25zdCBtb21lbnQgPSBtb21lbnROcztcblxuZGVjbGFyZSBsZXQgcGVyc2lhbkRhdGU6IGFueTtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGFtaW4tcGVyc2lhbi1kYXRlLXBpY2tlcicsXG4gIHRlbXBsYXRlVXJsOiAnLi90YW1pbi1wZXJzaWFuLWRhdGUtcGlja2VyLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vdGFtaW4tcGVyc2lhbi1kYXRlLXBpY2tlci5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFRhbWluUGVyc2lhbkRhdGVQaWNrZXJDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICBkYXlEYXRhID0gW107XG4gIHllYXJEYXRhID0gW107XG4gIG1vbnRoRGF0YSA9IFtdO1xuICB2aWV3U3RhdGU6IHN0cmluZztcbiAgcHJpdmF0ZSBfY3VycmVudERhdGU6IERhdGU7XG4gIEBPdXRwdXQoKSBkYXRlQ2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXI8RGF0ZT4oKTtcbiAgQE91dHB1dCgpIGNhbmNlbCA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcblxuICBASW5wdXQoKSBzZXQgY3VycmVudERhdGUoZGF0ZTogRGF0ZSkge1xuICAgIGlmIChkYXRlICE9PSB1bmRlZmluZWQgJiYgZGF0ZSAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5fY3VycmVudERhdGUgPSBkYXRlO1xuICAgICAgdGhpcy5nZW5lcmF0ZURheURhdGEoKTtcbiAgICB9XG4gIH1cblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMub25DaGFuZ2VWaWV3KCdEYXlQaWNrZXInKTtcbiAgfVxuXG4gIGdldCBjdXJyZW50RGF0ZSgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy5fY3VycmVudERhdGU7XG4gIH1cblxuICBnZXQgY3VycmVudE1vbnRoTmFtZSgpOiBzdHJpbmcge1xuICAgIC8vIHJldHVybiBtb21lbnQodGhpcy5jdXJyZW50RGF0ZSkubG9jYWxlKCdmYScpLmZvcm1hdCgnTU1NTScpO1xuICAgIHJldHVybiAobmV3IHBlcnNpYW5EYXRlKHRoaXMuY3VycmVudERhdGUpKS5mb3JtYXQoJ01NTU0nKTtcbiAgfVxuXG4gIGdldCBjdXJyZW50WWVhcigpOiBudW1iZXIge1xuICAgIC8vIHJldHVybiBtb21lbnQodGhpcy5jdXJyZW50RGF0ZSkualllYXIoKTtcbiAgICByZXR1cm4gKG5ldyBwZXJzaWFuRGF0ZSh0aGlzLmN1cnJlbnREYXRlKSkueWVhcigpO1xuICB9XG5cbiAgZ2VuZXJhdGVEYXlEYXRhKCk6IHZvaWQge1xuICAgIHRoaXMuZGF5RGF0YSA9IFtdO1xuICAgIC8vIGNvbnN0IHRvZGF5ID0gbW9tZW50KHRoaXMuY3VycmVudERhdGUgIT09IHVuZGVmaW5lZCA/IHRoaXMuY3VycmVudERhdGUgOiBuZXcgRGF0ZSgpKTtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBwZXJzaWFuRGF0ZSh0aGlzLmN1cnJlbnREYXRlICE9PSB1bmRlZmluZWQgPyB0aGlzLmN1cnJlbnREYXRlIDogbmV3IERhdGUoKSk7XG4gICAgLy8gY29uc3QgY3VycmVudE1vbnRoID0gdG9kYXkuak1vbnRoKCkgKyAxO1xuICAgIGNvbnN0IGN1cnJlbnRNb250aCA9IHRvZGF5Lm1vbnRoKCk7XG4gICAgLy8gY29uc3QgY3VycmVudERheSA9IHRvZGF5LmpEYXRlKCk7XG4gICAgY29uc3QgY3VycmVudERheSA9IHRvZGF5LmRhdGUoKTtcbiAgICAvLyBjb25zdCBmaXJzdERheUluTW9udGggPSB0b2RheS5zdGFydE9mKCdqTW9udGgnKTtcbiAgICBjb25zdCBmaXJzdERheUluTW9udGggPSB0b2RheS5zdGFydE9mKCdtb250aCcpO1xuICAgIC8vIGNvbnN0IGZpcnN0RWxlbWVudEluR3JpZCA9IGZpcnN0RGF5SW5Nb250aC5zdWJ0cmFjdChmaXJzdERheUluTW9udGguakRheSgpLCAnZGF5Jyk7XG4gICAgY29uc3QgZmlyc3RFbGVtZW50SW5HcmlkID0gZmlyc3REYXlJbk1vbnRoLnN1YnRyYWN0KCdkYXlzJywgZmlyc3REYXlJbk1vbnRoLmRheSgpKTtcblxuICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDQyOyBpKyspIHtcbiAgICAgIGNvbnN0IHRtcCA9IGZpcnN0RWxlbWVudEluR3JpZC5jbG9uZSgpLmFkZChpLCAnZCcpLmhvdXIoMjMpO1xuICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgeWVhcjogdG1wLnllYXIoKSxcbiAgICAgICAgbW9udGg6IHRtcC5tb250aCgpLFxuICAgICAgICBkYXk6IHRtcC5kYXRlKCksXG4gICAgICAgIHBlcnNpYW5EYXk6IHRtcC5kYXRlKCksXG4gICAgICAgIHRvZGF5OiAodG1wLm1vbnRoKCkgPT09IGN1cnJlbnRNb250aCkgJiYgKHRtcC5kYXRlKCkgPT09IGN1cnJlbnREYXkpLFxuICAgICAgICBkYXRlOiB0bXAudG9EYXRlKCksXG4gICAgICAgIG5leHRQcmV2TW9udGg6IHRtcC5tb250aCgpICE9PSBjdXJyZW50TW9udGhcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLmRheURhdGEgPSBkYXRhO1xuICB9XG5cbiAgZ2VuZXJhdGVZZWFyRGF0YShzdGFydFllYXIpOiB2b2lkIHtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBwZXJzaWFuRGF0ZSh0aGlzLmN1cnJlbnREYXRlKTtcbiAgICBjb25zdCBjdXJyZW50WWVhciA9IHRvZGF5LnllYXIoKTtcbiAgICB0aGlzLnllYXJEYXRhID0gW107XG4gICAgY29uc3QgeWVhciA9IHN0YXJ0WWVhcjtcblxuICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpKyspIHtcbiAgICAgIGRhdGEucHVzaCh7XG4gICAgICAgIHllYXI6IHllYXIgKyBpLFxuICAgICAgICBjdXJyZW50WWVhcjogY3VycmVudFllYXIgPT09ICh5ZWFyICsgaSlcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLnllYXJEYXRhID0gZGF0YTtcbiAgfVxuXG4gIGdlbmVyYXRlTW9udGhEYXRhKCk6IHZvaWQge1xuICAgIGNvbnN0IHRtcCA9IG5ldyBwZXJzaWFuRGF0ZSh0aGlzLmN1cnJlbnREYXRlKTtcbiAgICBjb25zdCBjdXJyZW50TW9udGggPSB0bXAubW9udGgoKTtcbiAgICB0aGlzLm1vbnRoRGF0YSA9IFtcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ9mB2LHZiNix2K/bjNmGJyxcbiAgICAgICAgbW9udGg6IDEsXG4gICAgICAgIGN1cnJlbnRNb250aDogY3VycmVudE1vbnRoID09PSAxXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAn2KfYsdiv24zYqNmH2LTYqicsXG4gICAgICAgIG1vbnRoOiAyLFxuICAgICAgICBjdXJyZW50TW9udGg6IGN1cnJlbnRNb250aCA9PT0gMlxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ9iu2LHYr9in2K8nLFxuICAgICAgICBtb250aDogMyxcbiAgICAgICAgY3VycmVudE1vbnRoOiBjdXJyZW50TW9udGggPT09IDNcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfYqtuM2LEnLFxuICAgICAgICBtb250aDogNCxcbiAgICAgICAgY3VycmVudE1vbnRoOiBjdXJyZW50TW9udGggPT09IDRcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfZhdix2K/Yp9ivJyxcbiAgICAgICAgbW9udGg6IDUsXG4gICAgICAgIGN1cnJlbnRNb250aDogY3VycmVudE1vbnRoID09PSA1XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAn2LTZh9ix24zZiNixJyxcbiAgICAgICAgbW9udGg6IDYsXG4gICAgICAgIGN1cnJlbnRNb250aDogY3VycmVudE1vbnRoID09PSA2XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAn2YXZh9ixJyxcbiAgICAgICAgbW9udGg6IDcsXG4gICAgICAgIGN1cnJlbnRNb250aDogY3VycmVudE1vbnRoID09PSA3XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAn2KLYqNin2YYnLFxuICAgICAgICBtb250aDogOCxcbiAgICAgICAgY3VycmVudE1vbnRoOiBjdXJyZW50TW9udGggPT09IDhcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfYotiw2LEnLFxuICAgICAgICBtb250aDogOSxcbiAgICAgICAgY3VycmVudE1vbnRoOiBjdXJyZW50TW9udGggPT09IDlcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfYr9uMJyxcbiAgICAgICAgbW9udGg6IDEwLFxuICAgICAgICBjdXJyZW50TW9udGg6IGN1cnJlbnRNb250aCA9PT0gMTBcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ9io2YfZhdmGJyxcbiAgICAgICAgbW9udGg6IDExLFxuICAgICAgICBjdXJyZW50TW9udGg6IGN1cnJlbnRNb250aCA9PT0gMTFcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfYp9iz2YHZhtivJyxcbiAgICAgICAgbW9udGg6IDEyLFxuICAgICAgICBjdXJyZW50TW9udGg6IGN1cnJlbnRNb250aCA9PT0gMTJcbiAgICAgIH1cbiAgICBdO1xuICB9XG5cbiAgaGlkZSgpIHtcbiAgICB0aGlzLmNhbmNlbC5lbWl0KCk7XG4gIH1cblxuICBvblByZXZNb250aCgpOiB2b2lkIHtcbiAgICBsZXQgdG9kYXkgPSBuZXcgcGVyc2lhbkRhdGUodGhpcy5jdXJyZW50RGF0ZSk7XG4gICAgdG9kYXkgPSB0b2RheS5zdWJ0cmFjdCgnbW9udGhzJywgMSk7XG4gICAgdG9kYXkuZGF0ZSgxKTtcbiAgICB0aGlzLmN1cnJlbnREYXRlID0gdG9kYXkudG9EYXRlKCk7XG4gICAgdGhpcy5nZW5lcmF0ZURheURhdGEoKTtcbiAgfVxuXG4gIG9uTmV4dE1vbnRoKCk6IHZvaWQge1xuICAgIGxldCB0b2RheSA9IG5ldyBwZXJzaWFuRGF0ZSh0aGlzLmN1cnJlbnREYXRlKTtcbiAgICB0b2RheSA9IHRvZGF5LmFkZCgnbW9udGhzJywgMSk7XG4gICAgdG9kYXkuZGF0ZSgxKTtcbiAgICB0aGlzLmN1cnJlbnREYXRlID0gdG9kYXkudG9EYXRlKCk7XG4gICAgdGhpcy5nZW5lcmF0ZURheURhdGEoKTtcbiAgfVxuXG4gIG9uVG9kYXkoKTogdm9pZCB7XG4gICAgdGhpcy5jdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgdGhpcy5nZW5lcmF0ZURheURhdGEoKTtcbiAgICB0aGlzLmRhdGVDaGFuZ2VkLmVtaXQodGhpcy5fY3VycmVudERhdGUpO1xuICB9XG5cbiAgb25TZXREYXkoZGF0ZSk6IHZvaWQge1xuICAgIHRoaXMuY3VycmVudERhdGUgPSBuZXcgRGF0ZShkYXRlKTtcbiAgICB0aGlzLmdlbmVyYXRlRGF5RGF0YSgpO1xuICAgIHRoaXMuZGF0ZUNoYW5nZWQuZW1pdCh0aGlzLl9jdXJyZW50RGF0ZSk7XG4gIH1cblxuICBzZXRWaWV3KCkge1xuICAgIHRoaXMudmlld1N0YXRlID0gJ0RheVBpY2tlcic7XG4gIH1cblxuICBvbkNoYW5nZVZpZXcodmlld05hbWUpOiB2b2lkIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IHBlcnNpYW5EYXRlKHRoaXMuY3VycmVudERhdGUpO1xuICAgICAgc3dpdGNoICh2aWV3TmFtZSkge1xuICAgICAgICBjYXNlICdZZWFyUGlja2VyJyA6XG4gICAgICAgICAgdGhpcy52aWV3U3RhdGUgPSAnWWVhclBpY2tlcic7XG4gICAgICAgICAgdGhpcy5nZW5lcmF0ZVllYXJEYXRhKHRvZGF5LnllYXIoKSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ01vbnRoUGlja2VyJyA6XG4gICAgICAgICAgdGhpcy52aWV3U3RhdGUgPSAnTW9udGhQaWNrZXInO1xuICAgICAgICAgIHRoaXMuZ2VuZXJhdGVNb250aERhdGEoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRGF5UGlja2VyJyA6XG4gICAgICAgICAgdGhpcy52aWV3U3RhdGUgPSAnRGF5UGlja2VyJztcbiAgICAgICAgICB0aGlzLmdlbmVyYXRlRGF5RGF0YSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgb25QcmV2WWVhckdyb3VwKCk6IHZvaWQge1xuICAgIGNvbnN0IHN0YXJ0WWVhciA9IHRoaXMueWVhckRhdGFbMF0ueWVhciAtIDIwO1xuICAgIHRoaXMuZ2VuZXJhdGVZZWFyRGF0YShzdGFydFllYXIpO1xuICB9XG5cbiAgb25OZXh0WWVhckdyb3VwKCk6IHZvaWQge1xuICAgIGNvbnN0IHN0YXJ0WWVhciA9IHRoaXMueWVhckRhdGFbMF0ueWVhciArIDIwO1xuICAgIHRoaXMuZ2VuZXJhdGVZZWFyRGF0YShzdGFydFllYXIpO1xuICB9XG5cbiAgb25UaGlzWWVhcigpOiB2b2lkIHtcbiAgICB0aGlzLmN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcbiAgICB0aGlzLm9uQ2hhbmdlVmlldygnRGF5UGlja2VyJyk7XG4gIH1cblxuICBvblRoaXNNb250aCgpOiB2b2lkIHtcbiAgICB0aGlzLmN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcbiAgICB0aGlzLm9uQ2hhbmdlVmlldygnRGF5UGlja2VyJyk7XG4gIH1cblxuICBvblNldFllYXIoeWVhcik6IHZvaWQge1xuICAgIC8vIGNvbnN0IHRtcCA9IG1vbWVudCh0aGlzLmN1cnJlbnREYXRlKTtcbiAgICBjb25zdCB0bXAgPSBuZXcgcGVyc2lhbkRhdGUodGhpcy5jdXJyZW50RGF0ZSk7XG4gICAgdG1wLnllYXIoeWVhcik7XG4gICAgdGhpcy5jdXJyZW50RGF0ZSA9IHRtcC50b0RhdGUoKTtcbiAgICB0aGlzLm9uQ2hhbmdlVmlldygnRGF5UGlja2VyJyk7XG4gIH1cblxuICBvblNldE1vbnRoKG1vbnRoKTogdm9pZCB7XG4gICAgLy8gY29uc3QgdG1wID0gbW9tZW50KHRoaXMuY3VycmVudERhdGUpO1xuICAgIGNvbnN0IHRtcCA9IG5ldyBwZXJzaWFuRGF0ZSh0aGlzLmN1cnJlbnREYXRlKTtcbiAgICB0bXAubW9udGgobW9udGgpO1xuICAgIHRoaXMuY3VycmVudERhdGUgPSB0bXAudG9EYXRlKCk7XG4gICAgdGhpcy5vbkNoYW5nZVZpZXcoJ0RheVBpY2tlcicpO1xuICB9XG59XG5cblxuLypcbmltcG9ydCB7Q29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkluaXQsIE91dHB1dH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1RhbWluUGVyc2lhbkRhdGV9IGZyb20gJy4uLy4uLy4uL3B1YmxpY19hcGknO1xuLy8gaW1wb3J0ICogYXMgbW9tZW50TnMgZnJvbSAnamFsYWxpLW1vbWVudCc7XG5cbi8vIGNvbnN0IG1vbWVudCA9IG1vbWVudE5zO1xuXG4vLyBkZWNsYXJlIGxldCBwZXJzaWFuRGF0ZTogYW55O1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0YW1pbi1wZXJzaWFuLWRhdGUtcGlja2VyJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3RhbWluLXBlcnNpYW4tZGF0ZS1waWNrZXIuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi90YW1pbi1wZXJzaWFuLWRhdGUtcGlja2VyLmNvbXBvbmVudC5zY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgVGFtaW5QZXJzaWFuRGF0ZVBpY2tlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIGRheURhdGEgPSBbXTtcbiAgeWVhckRhdGEgPSBbXTtcbiAgbW9udGhEYXRhID0gW107XG4gIHZpZXdTdGF0ZTogc3RyaW5nO1xuICBwcml2YXRlIF9jdXJyZW50RGF0ZTogRGF0ZTtcbiAgQE91dHB1dCgpIGRhdGVDaGFuZ2VkID0gbmV3IEV2ZW50RW1pdHRlcjxEYXRlPigpO1xuICBAT3V0cHV0KCkgY2FuY2VsID0gbmV3IEV2ZW50RW1pdHRlcjx2b2lkPigpO1xuXG4gIEBJbnB1dCgpIHNldCBjdXJyZW50RGF0ZShkYXRlOiBEYXRlKSB7XG4gICAgaWYgKGRhdGUgIT09IHVuZGVmaW5lZCAmJiBkYXRlICE9PSBudWxsKSB7XG4gICAgICB0aGlzLl9jdXJyZW50RGF0ZSA9IGRhdGU7XG4gICAgICB0aGlzLmdlbmVyYXRlRGF5RGF0YSgpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5vbkNoYW5nZVZpZXcoJ0RheVBpY2tlcicpO1xuICB9XG5cbiAgZ2V0IGN1cnJlbnREYXRlKCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLl9jdXJyZW50RGF0ZTtcbiAgfVxuXG4gIGdldCBjdXJyZW50TW9udGhOYW1lKCk6IHN0cmluZyB7XG4gICAgLy8gcmV0dXJuIG1vbWVudCh0aGlzLmN1cnJlbnREYXRlKS5sb2NhbGUoJ2ZhJykuZm9ybWF0KCdNTU1NJyk7XG4gICAgLy8gcmV0dXJuIChuZXcgcGVyc2lhbkRhdGUodGhpcy5jdXJyZW50RGF0ZSkpLmZvcm1hdCgnTU1NTScpO1xuICAgIHJldHVybiAoVGFtaW5QZXJzaWFuRGF0ZS5HcmVnb3JpYW5Ub0phbGFsaSh0aGlzLmN1cnJlbnREYXRlKS5zcGxpdCgnLycpWzFdKTtcbiAgfVxuXG4gIGdldCBjdXJyZW50WWVhcigpOiBudW1iZXIge1xuICAgIC8vIHJldHVybiBtb21lbnQodGhpcy5jdXJyZW50RGF0ZSkualllYXIoKTtcbiAgICAvLyByZXR1cm4gKG5ldyBwZXJzaWFuRGF0ZSh0aGlzLmN1cnJlbnREYXRlKSkueWVhcigpO1xuICAgIHJldHVybiBOdW1iZXIoVGFtaW5QZXJzaWFuRGF0ZS5HcmVnb3JpYW5Ub0phbGFsaSh0aGlzLmN1cnJlbnREYXRlKS5zcGxpdCgnLycpWzBdKTtcbiAgfVxuXG4gIGdlbmVyYXRlRGF5RGF0YSgpOiB2b2lkIHtcbiAgICB0aGlzLmRheURhdGEgPSBbXTtcbiAgICAvLyBjb25zdCB0b2RheSA9IG1vbWVudCh0aGlzLmN1cnJlbnREYXRlICE9PSB1bmRlZmluZWQgPyB0aGlzLmN1cnJlbnREYXRlIDogbmV3IERhdGUoKSk7XG4gICAgY29uc3QgdG9kYXkgPSB0aGlzLmN1cnJlbnREYXRlICE9PSB1bmRlZmluZWQgPyB0aGlzLmN1cnJlbnREYXRlIDogbmV3IERhdGUoKTtcbiAgICAvLyBjb25zdCBjdXJyZW50TW9udGggPSB0b2RheS5qTW9udGgoKSArIDE7XG4gICAgLy8gY29uc3QgY3VycmVudE1vbnRoID0gdG9kYXkubW9udGgoKTtcbiAgICBjb25zdCBjdXJyZW50TW9udGggPSB0b2RheS5nZXRNb250aCgpO1xuICAgIC8vIGNvbnN0IGN1cnJlbnREYXkgPSB0b2RheS5qRGF0ZSgpO1xuICAgIGNvbnN0IGN1cnJlbnREYXkgPSB0b2RheS5nZXREYXRlKCk7XG4gICAgLy8gY29uc3QgZmlyc3REYXlJbk1vbnRoID0gdG9kYXkuc3RhcnRPZignak1vbnRoJyk7XG4gICAgLy8gY29uc3QgZmlyc3REYXlJbk1vbnRoID0gdG9kYXkuc3RhcnRPZignbW9udGgnKTtcbiAgICBjb25zdCBmaXJzdERheUluTW9udGggPSBUYW1pblBlcnNpYW5EYXRlLkZpcnN0RGF5SW5Nb250aCh0aGlzLmN1cnJlbnREYXRlICE9PSB1bmRlZmluZWQgPyB0aGlzLmN1cnJlbnREYXRlIDogbmV3IERhdGUoKSk7XG4gICAgLy8gY29uc3QgZmlyc3RFbGVtZW50SW5HcmlkID0gZmlyc3REYXlJbk1vbnRoLnN1YnRyYWN0KGZpcnN0RGF5SW5Nb250aC5qRGF5KCksICdkYXknKTtcbiAgICAvLyBjb25zdCBmaXJzdEVsZW1lbnRJbkdyaWQgPSBmaXJzdERheUluTW9udGguc3VidHJhY3QoJ2RheXMnLCBmaXJzdERheUluTW9udGguZGF5KCkpO1xuICAgIGNvbnN0IGZpcnN0RWxlbWVudEluR3JpZCA9IG5ldyBEYXRlKGZpcnN0RGF5SW5Nb250aC5nZXRUaW1lKCkpO1xuICAgIGZpcnN0RWxlbWVudEluR3JpZC5zZXREYXRlKGZpcnN0RWxlbWVudEluR3JpZC5nZXREYXRlKCkgLSAoZmlyc3RFbGVtZW50SW5HcmlkLmdldERheSgpICsgMikpO1xuXG4gICAgY29uc3QgZGF0YSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDI7IGkrKykge1xuICAgICAgLy8gY29uc3QgdG1wID0gZmlyc3RFbGVtZW50SW5HcmlkLmNsb25lKCkuYWRkKGksICdkJykuaG91cigyMyk7XG4gICAgICBjb25zdCB0bXAgPSBuZXcgRGF0ZShmaXJzdEVsZW1lbnRJbkdyaWQuZ2V0VGltZSgpKTtcbiAgICAgIHRtcC5zZXREYXRlKHRtcC5nZXREYXRlKCkgKyBpKTtcbiAgICAgIHRtcC5zZXRIb3VycygyMyk7XG4gICAgICBkYXRhLnB1c2goe1xuICAgICAgICB5ZWFyOiB0bXAuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgbW9udGg6IHRtcC5nZXRNb250aCgpLFxuICAgICAgICBkYXk6IHRtcC5nZXREYXRlKCksXG4gICAgICAgIHBlcnNpYW5EYXk6IFRhbWluUGVyc2lhbkRhdGUuR3JlZ29yaWFuVG9KYWxhbGkodG1wKS5zcGxpdCgnLycpWzJdLFxuICAgICAgICB0b2RheTogKHRtcC5nZXRNb250aCgpID09PSBjdXJyZW50TW9udGgpICYmICh0bXAuZ2V0RGF0ZSgpID09PSBjdXJyZW50RGF5KSxcbiAgICAgICAgZGF0ZTogdG1wLFxuICAgICAgICBuZXh0UHJldk1vbnRoOiB0bXAuZ2V0TW9udGgoKSAhPT0gY3VycmVudE1vbnRoXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5kYXlEYXRhID0gZGF0YTtcbiAgfVxuXG4gIGdlbmVyYXRlWWVhckRhdGEoc3RhcnRZZWFyKTogdm9pZCB7XG4gICAgY29uc3QgdG9kYXkgPSBUYW1pblBlcnNpYW5EYXRlLkdyZWdvcmlhblRvSmFsYWxpKHRoaXMuY3VycmVudERhdGUpO1xuICAgIGNvbnN0IGN1cnJlbnRZZWFyID0gdG9kYXkuc3BsaXQoJy8nKVswXTtcbiAgICB0aGlzLnllYXJEYXRhID0gW107XG4gICAgY29uc3QgeWVhciA9IHN0YXJ0WWVhcjtcblxuICAgIGNvbnN0IGRhdGEgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpKyspIHtcbiAgICAgIGRhdGEucHVzaCh7XG4gICAgICAgIHllYXI6IHllYXIgKyBpLFxuICAgICAgICBjdXJyZW50WWVhcjogY3VycmVudFllYXIgPT09ICh5ZWFyICsgaSlcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLnllYXJEYXRhID0gZGF0YTtcbiAgfVxuXG4gIGdlbmVyYXRlTW9udGhEYXRhKCk6IHZvaWQge1xuICAgIGNvbnN0IHRtcCA9IFRhbWluUGVyc2lhbkRhdGUuR3JlZ29yaWFuVG9KYWxhbGkodGhpcy5jdXJyZW50RGF0ZSk7XG4gICAgY29uc3QgY3VycmVudE1vbnRoID0gTnVtYmVyKHRtcC5zcGxpdCgnLycpWzFdKTtcbiAgICB0aGlzLm1vbnRoRGF0YSA9IFtcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ9mB2LHZiNix2K/bjNmGJyxcbiAgICAgICAgbW9udGg6IDEsXG4gICAgICAgIGN1cnJlbnRNb250aDogY3VycmVudE1vbnRoID09PSAxXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAn2KfYsdiv24zYqNmH2LTYqicsXG4gICAgICAgIG1vbnRoOiAyLFxuICAgICAgICBjdXJyZW50TW9udGg6IGN1cnJlbnRNb250aCA9PT0gMlxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgbmFtZTogJ9iu2LHYr9in2K8nLFxuICAgICAgICBtb250aDogMyxcbiAgICAgICAgY3VycmVudE1vbnRoOiBjdXJyZW50TW9udGggPT09IDNcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfYqtuM2LEnLFxuICAgICAgICBtb250aDogNCxcbiAgICAgICAgY3VycmVudE1vbnRoOiBjdXJyZW50TW9udGggPT09IDRcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfZhdix2K/Yp9ivJyxcbiAgICAgICAgbW9udGg6IDUsXG4gICAgICAgIGN1cnJlbnRNb250aDogY3VycmVudE1vbnRoID09PSA1XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAn2LTZh9ix24zZiNixJyxcbiAgICAgICAgbW9udGg6IDYsXG4gICAgICAgIGN1cnJlbnRNb250aDogY3VycmVudE1vbnRoID09PSA2XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAn2YXZh9ixJyxcbiAgICAgICAgbW9udGg6IDcsXG4gICAgICAgIGN1cnJlbnRNb250aDogY3VycmVudE1vbnRoID09PSA3XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBuYW1lOiAn2KLYqNin2YYnLFxuICAgICAgICBtb250aDogOCxcbiAgICAgICAgY3VycmVudE1vbnRoOiBjdXJyZW50TW9udGggPT09IDhcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfYotiw2LEnLFxuICAgICAgICBtb250aDogOSxcbiAgICAgICAgY3VycmVudE1vbnRoOiBjdXJyZW50TW9udGggPT09IDlcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfYr9uMJyxcbiAgICAgICAgbW9udGg6IDEwLFxuICAgICAgICBjdXJyZW50TW9udGg6IGN1cnJlbnRNb250aCA9PT0gMTBcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ9io2YfZhdmGJyxcbiAgICAgICAgbW9udGg6IDExLFxuICAgICAgICBjdXJyZW50TW9udGg6IGN1cnJlbnRNb250aCA9PT0gMTFcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIG5hbWU6ICfYp9iz2YHZhtivJyxcbiAgICAgICAgbW9udGg6IDEyLFxuICAgICAgICBjdXJyZW50TW9udGg6IGN1cnJlbnRNb250aCA9PT0gMTJcbiAgICAgIH1cbiAgICBdO1xuICB9XG5cbiAgaGlkZSgpIHtcbiAgICB0aGlzLmNhbmNlbC5lbWl0KCk7XG4gIH1cblxuICBvblByZXZNb250aCgpOiB2b2lkIHtcbiAgICBsZXQgdG9kYXkgPSBUYW1pblBlcnNpYW5EYXRlLkdldFByZXZNb250aCh0aGlzLmN1cnJlbnREYXRlKTtcbiAgICB0b2RheSA9IFRhbWluUGVyc2lhbkRhdGUuRmlyc3REYXlJbk1vbnRoKHRvZGF5KTtcbiAgICB0aGlzLmN1cnJlbnREYXRlID0gdG9kYXk7XG4gICAgdGhpcy5nZW5lcmF0ZURheURhdGEoKTtcbiAgfVxuXG4gIG9uTmV4dE1vbnRoKCk6IHZvaWQge1xuICAgIGxldCB0b2RheSA9IFRhbWluUGVyc2lhbkRhdGUuR2V0TmV4dE1vbnRoKHRoaXMuY3VycmVudERhdGUpO1xuICAgIHRvZGF5ID0gVGFtaW5QZXJzaWFuRGF0ZS5GaXJzdERheUluTW9udGgodG9kYXkpO1xuICAgIHRoaXMuY3VycmVudERhdGUgPSB0b2RheTtcbiAgICB0aGlzLmdlbmVyYXRlRGF5RGF0YSgpO1xuICB9XG5cbiAgb25Ub2RheSgpOiB2b2lkIHtcbiAgICB0aGlzLmN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcbiAgICB0aGlzLmdlbmVyYXRlRGF5RGF0YSgpO1xuICAgIHRoaXMuZGF0ZUNoYW5nZWQuZW1pdCh0aGlzLl9jdXJyZW50RGF0ZSk7XG4gIH1cblxuICBvblNldERheShkYXRlKTogdm9pZCB7XG4gICAgdGhpcy5jdXJyZW50RGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xuICAgIHRoaXMuZ2VuZXJhdGVEYXlEYXRhKCk7XG4gICAgdGhpcy5kYXRlQ2hhbmdlZC5lbWl0KHRoaXMuX2N1cnJlbnREYXRlKTtcbiAgfVxuXG4gIHNldFZpZXcoKSB7XG4gICAgdGhpcy52aWV3U3RhdGUgPSAnRGF5UGlja2VyJztcbiAgfVxuXG4gIG9uQ2hhbmdlVmlldyh2aWV3TmFtZSk6IHZvaWQge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZGVidWdnZXI7XG4gICAgICBjb25zdCB0b2RheSA9IFRhbWluUGVyc2lhbkRhdGUuR3JlZ29yaWFuVG9KYWxhbGkodGhpcy5jdXJyZW50RGF0ZSk7XG4gICAgICBzd2l0Y2ggKHZpZXdOYW1lKSB7XG4gICAgICAgIGNhc2UgJ1llYXJQaWNrZXInIDpcbiAgICAgICAgICB0aGlzLnZpZXdTdGF0ZSA9ICdZZWFyUGlja2VyJztcbiAgICAgICAgICB0aGlzLmdlbmVyYXRlWWVhckRhdGEoTnVtYmVyKHRvZGF5LnNwbGl0KCcvJylbMF0pKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnTW9udGhQaWNrZXInIDpcbiAgICAgICAgICB0aGlzLnZpZXdTdGF0ZSA9ICdNb250aFBpY2tlcic7XG4gICAgICAgICAgdGhpcy5nZW5lcmF0ZU1vbnRoRGF0YSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdEYXlQaWNrZXInIDpcbiAgICAgICAgICB0aGlzLnZpZXdTdGF0ZSA9ICdEYXlQaWNrZXInO1xuICAgICAgICAgIHRoaXMuZ2VuZXJhdGVEYXlEYXRhKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBvblByZXZZZWFyR3JvdXAoKTogdm9pZCB7XG4gICAgY29uc3Qgc3RhcnRZZWFyID0gdGhpcy55ZWFyRGF0YVswXS55ZWFyIC0gMjA7XG4gICAgdGhpcy5nZW5lcmF0ZVllYXJEYXRhKHN0YXJ0WWVhcik7XG4gIH1cblxuICBvbk5leHRZZWFyR3JvdXAoKTogdm9pZCB7XG4gICAgY29uc3Qgc3RhcnRZZWFyID0gdGhpcy55ZWFyRGF0YVswXS55ZWFyICsgMjA7XG4gICAgdGhpcy5nZW5lcmF0ZVllYXJEYXRhKHN0YXJ0WWVhcik7XG4gIH1cblxuICBvblRoaXNZZWFyKCk6IHZvaWQge1xuICAgIHRoaXMuY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIHRoaXMub25DaGFuZ2VWaWV3KCdEYXlQaWNrZXInKTtcbiAgfVxuXG4gIG9uVGhpc01vbnRoKCk6IHZvaWQge1xuICAgIHRoaXMuY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIHRoaXMub25DaGFuZ2VWaWV3KCdEYXlQaWNrZXInKTtcbiAgfVxuXG4gIG9uU2V0WWVhcih5ZWFyKTogdm9pZCB7XG4gICAgLy8gY29uc3QgdG1wID0gbW9tZW50KHRoaXMuY3VycmVudERhdGUpO1xuICAgIGNvbnN0IHRtcCA9IFRhbWluUGVyc2lhbkRhdGUuR3JlZ29yaWFuVG9KYWxhbGkodGhpcy5jdXJyZW50RGF0ZSk7XG4gICAgLy8gdG1wLnNwbGl0KCcvJylbMF0gPSB5ZWFyLnRvU3RyaW5nKCk7XG4gICAgdGhpcy5jdXJyZW50RGF0ZSA9IFRhbWluUGVyc2lhbkRhdGUuSmFsYWxpVG9HcmVnb3JpYW4oeWVhciwgTnVtYmVyKHRtcC5zcGxpdCgnLycpWzFdKSwgTnVtYmVyKHRtcC5zcGxpdCgnLycpWzJdKSk7XG4gICAgdGhpcy5vbkNoYW5nZVZpZXcoJ0RheVBpY2tlcicpO1xuICB9XG5cbiAgb25TZXRNb250aChtb250aCk6IHZvaWQge1xuICAgIC8vIGNvbnN0IHRtcCA9IG1vbWVudCh0aGlzLmN1cnJlbnREYXRlKTtcbiAgICBjb25zdCB0bXAgPSBUYW1pblBlcnNpYW5EYXRlLkdyZWdvcmlhblRvSmFsYWxpKHRoaXMuY3VycmVudERhdGUpO1xuICAgIC8vIHRtcC5tb250aChtb250aCk7XG4gICAgdGhpcy5jdXJyZW50RGF0ZSA9IFRhbWluUGVyc2lhbkRhdGUuSmFsYWxpVG9HcmVnb3JpYW4oTnVtYmVyKHRtcC5zcGxpdCgnLycpWzBdKSwgTnVtYmVyKG1vbnRoKSwgTnVtYmVyKHRtcC5zcGxpdCgnLycpWzJdKSk7XG4gICAgdGhpcy5vbkNoYW5nZVZpZXcoJ0RheVBpY2tlcicpO1xuICB9XG59XG4gKi9cbiJdfQ==