/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ChangeDetectorRef, Component, ElementRef, Injector, Input } from '@angular/core';
import { OverlayService } from '../services/overlay/overlay.service';
import { TaminRestService } from '../services/tamin-rest-service/tamin-rest.service';
import { TaminSecurityService } from '../services/tamin-security/tamin-security.service';
import { PersianDateTimePipe } from '../pipes/persian-date-time.pipe';
import { PersianNumberPipe } from '../pipes/persian-number.pipe';
import { Router } from '@angular/router';
import { FormBuilder } from '@angular/forms';
import { ConstantsService } from '../services/constants.service';
var TaminPageBaseComponent = /** @class */ (function () {
    function TaminPageBaseComponent(injector) {
        this.injector = injector;
        this.overlays = [];
        this.isModal = false;
        this._overlayService = injector.get(OverlayService);
        this._restService = injector.get(TaminRestService);
        this._securityService = injector.get(TaminSecurityService);
        this._persianDateTime = injector.get(PersianDateTimePipe);
        this._persianNumberPipe = injector.get(PersianNumberPipe);
        this._router = injector.get(Router);
        this._formBuilder = injector.get(FormBuilder);
        this._host = injector.get(ElementRef);
        this._changeDetectorRef = injector.get(ChangeDetectorRef);
        this._constants = injector.get(ConstantsService);
    }
    Object.defineProperty(TaminPageBaseComponent.prototype, "visible", {
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._host.nativeElement.style.display = val ? 'block' : 'none';
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TaminPageBaseComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        window.scrollTo(0, 0);
        this.internalInitialize();
        this.initializePage();
    };
    Object.defineProperty(TaminPageBaseComponent.prototype, "title", {
        get: /**
         * @return {?}
         */
        function () {
            return this._title;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._title = val;
            document.title = 'سازمان تامین اجتماعی' + ' - ' + this._title;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    TaminPageBaseComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.overlays.forEach((/**
         * @param {?} item
         * @return {?}
         */
        function (item) {
            _this._overlayService.hide(item.overlay);
        }));
        this.destroyPage();
        alertify.closeAll();
    };
    Object.defineProperty(TaminPageBaseComponent.prototype, "restService", {
        get: /**
         * @return {?}
         */
        function () {
            return this._restService;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TaminPageBaseComponent.prototype, "constants", {
        get: /**
         * @return {?}
         */
        function () {
            return this._constants;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TaminPageBaseComponent.prototype, "formBuilder", {
        get: /**
         * @return {?}
         */
        function () {
            return this._formBuilder;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TaminPageBaseComponent.prototype, "changeDetectorRef", {
        // get currentUser(): any {
        //   return this._securityService.currentUser;
        // }
        get: 
        // get currentUser(): any {
        //   return this._securityService.currentUser;
        // }
        /**
         * @return {?}
         */
        function () {
            return this._changeDetectorRef;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TaminPageBaseComponent.prototype, "securityService", {
        get: /**
         * @return {?}
         */
        function () {
            return this._securityService;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} date
     * @return {?}
     */
    TaminPageBaseComponent.prototype.getPersianDate = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        try {
            return this._persianDateTime.transform(new Date(date));
        }
        catch (_a) {
            return 'تاریخ نادرست';
        }
    };
    /**
     * @param {?} path
     * @return {?}
     */
    TaminPageBaseComponent.prototype.redirectTo = /**
     * @param {?} path
     * @return {?}
     */
    function (path) {
        this._router.navigate([path]);
    };
    /**
     * @param {?} title
     * @param {?} message
     * @param {?=} callback
     * @return {?}
     */
    TaminPageBaseComponent.prototype.showInfoMessageBox = /**
     * @param {?} title
     * @param {?} message
     * @param {?=} callback
     * @return {?}
     */
    function (title, message, callback) {
        if (callback === void 0) { callback = null; }
        if (callback) {
            alertify.alert(title, message, callback);
        }
        else {
            alertify.alert(title, message);
        }
    };
    /**
     * @param {?} title
     * @param {?} message
     * @param {?=} callback
     * @return {?}
     */
    TaminPageBaseComponent.prototype.showErrorMessageBox = /**
     * @param {?} title
     * @param {?} message
     * @param {?=} callback
     * @return {?}
     */
    function (title, message, callback) {
        if (callback === void 0) { callback = null; }
        /** @type {?} */
        var theTitle = "<span style=\"color: red\">" + title + "</span>";
        if (callback) {
            alertify.alert(theTitle, message, callback);
        }
        else {
            alertify.alert(theTitle, message);
        }
    };
    /**
     * @param {?} title
     * @param {?} message
     * @param {?} yesCallback
     * @param {?} noCallback
     * @return {?}
     */
    TaminPageBaseComponent.prototype.showQuestionBox = /**
     * @param {?} title
     * @param {?} message
     * @param {?} yesCallback
     * @param {?} noCallback
     * @return {?}
     */
    function (title, message, yesCallback, noCallback) {
        alertify.confirm(title, message, yesCallback, noCallback)
            .set({
            labels: { ok: 'بلی', cancel: 'خیر' }
        });
    };
    /**
     * @param {?} title
     * @param {?} message
     * @param {?} retryCallback
     * @param {?} cancelCallback
     * @return {?}
     */
    TaminPageBaseComponent.prototype.showRetryBox = /**
     * @param {?} title
     * @param {?} message
     * @param {?} retryCallback
     * @param {?} cancelCallback
     * @return {?}
     */
    function (title, message, retryCallback, cancelCallback) {
        alertify.confirm(title, message, retryCallback, cancelCallback)
            .set({
            labels: { ok: 'تلاش مجدد', cancel: 'انصراف' },
            'closable': false
        });
    };
    /**
     * @param {?} str
     * @return {?}
     */
    TaminPageBaseComponent.prototype.getPersianNumber = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        return this._persianNumberPipe.transform(str);
    };
    /**
     * @protected
     * @return {?}
     */
    TaminPageBaseComponent.prototype.initializePage = /**
     * @protected
     * @return {?}
     */
    function () {
    };
    /**
     * @protected
     * @return {?}
     */
    TaminPageBaseComponent.prototype.destroyPage = /**
     * @protected
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?=} element
     * @return {?}
     */
    TaminPageBaseComponent.prototype.showOverlay = /**
     * @param {?=} element
     * @return {?}
     */
    function (element) {
        if (element === void 0) { element = null; }
        if (this.overlays.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.overlay === element; })) >= 0) {
            return;
        }
        /** @type {?} */
        var overlay = this._overlayService.show(element);
        /** @type {?} */
        var id = (new Date()).getTime();
        this.overlays.push({
            overlay: overlay,
            id: id.toString()
        });
        return id.toString();
    };
    /**
     * @param {?} message
     * @param {?=} element
     * @return {?}
     */
    TaminPageBaseComponent.prototype.showOverlayWithMessage = /**
     * @param {?} message
     * @param {?=} element
     * @return {?}
     */
    function (message, element) {
        if (element === void 0) { element = null; }
        if (this.overlays.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.overlay === element; })) >= 0) {
            return;
        }
        /** @type {?} */
        var overlay = this._overlayService.showMessage(message, element);
        /** @type {?} */
        var id = (new Date()).getTime();
        this.overlays.push({
            overlay: overlay,
            id: id.toString()
        });
        return id.toString();
    };
    /**
     * @param {?} id
     * @return {?}
     */
    TaminPageBaseComponent.prototype.hideOverlay = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        /** @type {?} */
        var tmp = this.overlays.find((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.id === id; }));
        if (tmp) {
            this._overlayService.hide(tmp.overlay);
        }
        /** @type {?} */
        var index = this.overlays.findIndex((/**
         * @param {?} c
         * @return {?}
         */
        function (c) { return c.id === id; }));
        this.overlays.splice(index, 1);
    };
    /**
     * @private
     * @return {?}
     */
    TaminPageBaseComponent.prototype.internalInitialize = /**
     * @private
     * @return {?}
     */
    function () {
    };
    /**
     * @protected
     * @return {?}
     */
    TaminPageBaseComponent.prototype.loadPageData = /**
     * @protected
     * @return {?}
     */
    function () {
    };
    /**
     * @return {?}
     */
    TaminPageBaseComponent.prototype.onTour = /**
     * @return {?}
     */
    function () {
        introJs().setOptions({
            'nextLabel': 'بعد',
            'prevLabel': 'قبل',
            'skipLabel': 'خروج',
            'doneLabel': 'اتمام'
        }).start();
    };
    /**
     * @return {?}
     */
    TaminPageBaseComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () { return _this.loadPageData(); }), 0);
    };
    /**
     * @return {?}
     */
    TaminPageBaseComponent.prototype.openModal = /**
     * @return {?}
     */
    function () {
    };
    /**
     * @param {?} form
     * @return {?}
     */
    TaminPageBaseComponent.prototype.markFormGroupAsTouched = /**
     * @param {?} form
     * @return {?}
     */
    function (form) {
        ((/** @type {?} */ (Object))).values(form.controls).forEach((/**
         * @param {?} control
         * @return {?}
         */
        function (control) { return control.markAsTouched(); }));
    };
    /**
     * @return {?}
     */
    TaminPageBaseComponent.prototype.ngAfterContentChecked = /**
     * @return {?}
     */
    function () {
        this._changeDetectorRef.detectChanges();
    };
    TaminPageBaseComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tamin-page-base-component',
                    template: ''
                }] }
    ];
    /** @nocollapse */
    TaminPageBaseComponent.ctorParameters = function () { return [
        { type: Injector }
    ]; };
    TaminPageBaseComponent.propDecorators = {
        isModal: [{ type: Input }],
        visible: [{ type: Input }]
    };
    return TaminPageBaseComponent;
}());
export { TaminPageBaseComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._title;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype.overlays;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._overlayService;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._restService;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._securityService;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._persianDateTime;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._persianNumberPipe;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._router;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._constants;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._formBuilder;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._host;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype._changeDetectorRef;
    /** @type {?} */
    TaminPageBaseComponent.prototype.isModal;
    /**
     * @type {?}
     * @private
     */
    TaminPageBaseComponent.prototype.injector;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnZS1iYXNlLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3RhbWluLWZyYW1ld29yay8iLCJzb3VyY2VzIjpbImxpYi9iYXNlL3BhZ2UtYmFzZS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFHTCxpQkFBaUIsRUFDakIsU0FBUyxFQUNULFVBQVUsRUFDVixRQUFRLEVBQ1IsS0FBSyxFQUdOLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxxQ0FBcUMsQ0FBQztBQUNuRSxPQUFPLEVBQUMsZ0JBQWdCLEVBQUMsTUFBTSxtREFBbUQsQ0FBQztBQUNuRixPQUFPLEVBQUMsb0JBQW9CLEVBQUMsTUFBTSxtREFBbUQsQ0FBQztBQUN2RixPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSxpQ0FBaUMsQ0FBQztBQUNwRSxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSw4QkFBOEIsQ0FBQztBQUMvRCxPQUFPLEVBQUMsTUFBTSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDdkMsT0FBTyxFQUFDLFdBQVcsRUFBWSxNQUFNLGdCQUFnQixDQUFDO0FBQ3RELE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLCtCQUErQixDQUFDO0FBTS9EO0lBdUJFLGdDQUFvQixRQUFrQjtRQUFsQixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBakI5QixhQUFRLEdBQUcsRUFBRSxDQUFDO1FBV2IsWUFBTyxHQUFHLEtBQUssQ0FBQztRQU92QixJQUFJLENBQUMsZUFBZSxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDcEQsSUFBSSxDQUFDLFlBQVksR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDbkQsSUFBSSxDQUFDLGdCQUFnQixHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUMzRCxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1FBQzFELElBQUksQ0FBQyxrQkFBa0IsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFDMUQsSUFBSSxDQUFDLE9BQU8sR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxZQUFZLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUM5QyxJQUFJLENBQUMsS0FBSyxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDdEMsSUFBSSxDQUFDLGtCQUFrQixHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUMxRCxJQUFJLENBQUMsVUFBVSxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztJQUNuRCxDQUFDO0lBZkQsc0JBQWEsMkNBQU87Ozs7O1FBQXBCLFVBQXFCLEdBQVk7WUFDL0IsSUFBSSxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO1FBQ2xFLENBQUM7OztPQUFBOzs7O0lBZUQseUNBQVE7OztJQUFSO1FBQ0UsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDdEIsSUFBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7UUFDMUIsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3hCLENBQUM7SUFFRCxzQkFBSSx5Q0FBSzs7OztRQUtUO1lBQ0UsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQ3JCLENBQUM7Ozs7O1FBUEQsVUFBVSxHQUFXO1lBQ25CLElBQUksQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDO1lBQ2xCLFFBQVEsQ0FBQyxLQUFLLEdBQUcsc0JBQXNCLEdBQUcsS0FBSyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDaEUsQ0FBQzs7O09BQUE7Ozs7SUFNRCw0Q0FBVzs7O0lBQVg7UUFBQSxpQkFNQztRQUxDLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTzs7OztRQUFDLFVBQUMsSUFBUztZQUM5QixLQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDMUMsQ0FBQyxFQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDbkIsUUFBUSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ3RCLENBQUM7SUFFRCxzQkFBSSwrQ0FBVzs7OztRQUFmO1lBQ0UsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDO1FBQzNCLENBQUM7OztPQUFBO0lBRUQsc0JBQUksNkNBQVM7Ozs7UUFBYjtZQUNFLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUN6QixDQUFDOzs7T0FBQTtJQUVELHNCQUFJLCtDQUFXOzs7O1FBQWY7WUFDRSxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDM0IsQ0FBQzs7O09BQUE7SUFNRCxzQkFBSSxxREFBaUI7UUFKckIsMkJBQTJCO1FBQzNCLDhDQUE4QztRQUM5QyxJQUFJOzs7Ozs7OztRQUVKO1lBQ0UsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUM7UUFDakMsQ0FBQzs7O09BQUE7SUFFRCxzQkFBSSxtREFBZTs7OztRQUFuQjtZQUNFLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDO1FBQy9CLENBQUM7OztPQUFBOzs7OztJQUVELCtDQUFjOzs7O0lBQWQsVUFBZSxJQUFTO1FBQ3RCLElBQUk7WUFDRixPQUFPLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztTQUN4RDtRQUFDLFdBQU07WUFDTixPQUFPLGNBQWMsQ0FBQztTQUN2QjtJQUNILENBQUM7Ozs7O0lBRUQsMkNBQVU7Ozs7SUFBVixVQUFXLElBQUk7UUFDYixJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDaEMsQ0FBQzs7Ozs7OztJQUVELG1EQUFrQjs7Ozs7O0lBQWxCLFVBQW1CLEtBQWEsRUFBRSxPQUFlLEVBQUUsUUFBeUI7UUFBekIseUJBQUEsRUFBQSxlQUF5QjtRQUMxRSxJQUFJLFFBQVEsRUFBRTtZQUNaLFFBQVEsQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQztTQUMxQzthQUFNO1lBQ0wsUUFBUSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FDaEM7SUFDSCxDQUFDOzs7Ozs7O0lBRUQsb0RBQW1COzs7Ozs7SUFBbkIsVUFBb0IsS0FBYSxFQUFFLE9BQWUsRUFBRSxRQUF5QjtRQUF6Qix5QkFBQSxFQUFBLGVBQXlCOztZQUNyRSxRQUFRLEdBQUcsZ0NBQTRCLEtBQUssWUFBUztRQUMzRCxJQUFJLFFBQVEsRUFBRTtZQUNaLFFBQVEsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxRQUFRLENBQUMsQ0FBQztTQUM3QzthQUFNO1lBQ0wsUUFBUSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FDbkM7SUFDSCxDQUFDOzs7Ozs7OztJQUVELGdEQUFlOzs7Ozs7O0lBQWYsVUFBZ0IsS0FBYSxFQUFFLE9BQWUsRUFBRSxXQUFxQixFQUFFLFVBQW9CO1FBQ3pGLFFBQVEsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxXQUFXLEVBQUUsVUFBVSxDQUFDO2FBQ3RELEdBQUcsQ0FBQztZQUNILE1BQU0sRUFBRSxFQUFDLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBQztTQUNuQyxDQUFDLENBQUM7SUFDUCxDQUFDOzs7Ozs7OztJQUVELDZDQUFZOzs7Ozs7O0lBQVosVUFBYSxLQUFhLEVBQUUsT0FBZSxFQUFFLGFBQXVCLEVBQUUsY0FBd0I7UUFDNUYsUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsT0FBTyxFQUFFLGFBQWEsRUFBRSxjQUFjLENBQUM7YUFDNUQsR0FBRyxDQUFDO1lBQ0gsTUFBTSxFQUFFLEVBQUMsRUFBRSxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFDO1lBQzNDLFVBQVUsRUFBRSxLQUFLO1NBQ2xCLENBQUMsQ0FBQztJQUNQLENBQUM7Ozs7O0lBRUQsaURBQWdCOzs7O0lBQWhCLFVBQWlCLEdBQVc7UUFDMUIsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2hELENBQUM7Ozs7O0lBRVMsK0NBQWM7Ozs7SUFBeEI7SUFDQSxDQUFDOzs7OztJQUVTLDRDQUFXOzs7O0lBQXJCO0lBQ0EsQ0FBQzs7Ozs7SUFFRCw0Q0FBVzs7OztJQUFYLFVBQVksT0FBbUI7UUFBbkIsd0JBQUEsRUFBQSxjQUFtQjtRQUM3QixJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUzs7OztRQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLE9BQU8sS0FBSyxPQUFPLEVBQXJCLENBQXFCLEVBQUMsSUFBSSxDQUFDLEVBQUU7WUFDNUQsT0FBTztTQUNSOztZQUNLLE9BQU8sR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUM7O1lBQzVDLEVBQUUsR0FBRyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQyxPQUFPLEVBQUU7UUFDakMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7WUFDakIsT0FBTyxFQUFFLE9BQU87WUFDaEIsRUFBRSxFQUFFLEVBQUUsQ0FBQyxRQUFRLEVBQUU7U0FDbEIsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDdkIsQ0FBQzs7Ozs7O0lBRUQsdURBQXNCOzs7OztJQUF0QixVQUF1QixPQUFlLEVBQUUsT0FBbUI7UUFBbkIsd0JBQUEsRUFBQSxjQUFtQjtRQUN6RCxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUzs7OztRQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLE9BQU8sS0FBSyxPQUFPLEVBQXJCLENBQXFCLEVBQUMsSUFBSSxDQUFDLEVBQUU7WUFDNUQsT0FBTztTQUNSOztZQUNLLE9BQU8sR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDOztZQUM1RCxFQUFFLEdBQUcsQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLENBQUMsT0FBTyxFQUFFO1FBQ2pDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDO1lBQ2pCLE9BQU8sRUFBRSxPQUFPO1lBQ2hCLEVBQUUsRUFBRSxFQUFFLENBQUMsUUFBUSxFQUFFO1NBQ2xCLENBQUMsQ0FBQztRQUNILE9BQU8sRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ3ZCLENBQUM7Ozs7O0lBRUQsNENBQVc7Ozs7SUFBWCxVQUFZLEVBQVU7O1lBQ2QsR0FBRyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSTs7OztRQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQVgsQ0FBVyxFQUFDO1FBQ2hELElBQUksR0FBRyxFQUFFO1lBQ1AsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ3hDOztZQUNLLEtBQUssR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVM7Ozs7UUFBQyxVQUFBLENBQUMsSUFBSSxPQUFBLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFYLENBQVcsRUFBQztRQUN2RCxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDakMsQ0FBQzs7Ozs7SUFFTyxtREFBa0I7Ozs7SUFBMUI7SUFDQSxDQUFDOzs7OztJQUVTLDZDQUFZOzs7O0lBQXRCO0lBQ0EsQ0FBQzs7OztJQUVELHVDQUFNOzs7SUFBTjtRQUNFLE9BQU8sRUFBRSxDQUFDLFVBQVUsQ0FDbEI7WUFDRSxXQUFXLEVBQUUsS0FBSztZQUNsQixXQUFXLEVBQUUsS0FBSztZQUNsQixXQUFXLEVBQUUsTUFBTTtZQUNuQixXQUFXLEVBQUUsT0FBTztTQUNyQixDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDZixDQUFDOzs7O0lBRUQsZ0RBQWU7OztJQUFmO1FBQUEsaUJBRUM7UUFEQyxVQUFVOzs7UUFBQyxjQUFNLE9BQUEsS0FBSSxDQUFDLFlBQVksRUFBRSxFQUFuQixDQUFtQixHQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzNDLENBQUM7Ozs7SUFFRCwwQ0FBUzs7O0lBQVQ7SUFDQSxDQUFDOzs7OztJQUVELHVEQUFzQjs7OztJQUF0QixVQUF1QixJQUFlO1FBQ3BDLENBQUMsbUJBQUssTUFBTSxFQUFBLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLE9BQU87Ozs7UUFBQyxVQUFBLE9BQU8sSUFBSSxPQUFBLE9BQU8sQ0FBQyxhQUFhLEVBQUUsRUFBdkIsQ0FBdUIsRUFBQyxDQUFDO0lBQ2xGLENBQUM7Ozs7SUFFRCxzREFBcUI7OztJQUFyQjtRQUNFLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUMxQyxDQUFDOztnQkF6TUYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSwyQkFBMkI7b0JBQ3JDLFFBQVEsRUFBRSxFQUFFO2lCQUNiOzs7O2dCQXJCQyxRQUFROzs7MEJBbUNQLEtBQUs7MEJBRUwsS0FBSzs7SUF1TFIsNkJBQUM7Q0FBQSxBQTFNRCxJQTBNQztTQXRNWSxzQkFBc0I7Ozs7OztJQUNqQyx3Q0FBdUI7Ozs7O0lBQ3ZCLDBDQUFzQjs7Ozs7SUFDdEIsaURBQXdDOzs7OztJQUN4Qyw4Q0FBdUM7Ozs7O0lBQ3ZDLGtEQUErQzs7Ozs7SUFDL0Msa0RBQThDOzs7OztJQUM5QyxvREFBOEM7Ozs7O0lBQzlDLHlDQUF3Qjs7Ozs7SUFDeEIsNENBQXFDOzs7OztJQUNyQyw4Q0FBa0M7Ozs7O0lBQ2xDLHVDQUEwQjs7Ozs7SUFDMUIsb0RBQThDOztJQUM5Qyx5Q0FBeUI7Ozs7O0lBTWIsMENBQTBCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBBZnRlckNvbnRlbnRDaGVja2VkLFxyXG4gIEFmdGVyVmlld0luaXQsXHJcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgQ29tcG9uZW50LFxyXG4gIEVsZW1lbnRSZWYsXHJcbiAgSW5qZWN0b3IsXHJcbiAgSW5wdXQsXHJcbiAgT25EZXN0cm95LFxyXG4gIE9uSW5pdFxyXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge092ZXJsYXlTZXJ2aWNlfSBmcm9tICcuLi9zZXJ2aWNlcy9vdmVybGF5L292ZXJsYXkuc2VydmljZSc7XHJcbmltcG9ydCB7VGFtaW5SZXN0U2VydmljZX0gZnJvbSAnLi4vc2VydmljZXMvdGFtaW4tcmVzdC1zZXJ2aWNlL3RhbWluLXJlc3Quc2VydmljZSc7XHJcbmltcG9ydCB7VGFtaW5TZWN1cml0eVNlcnZpY2V9IGZyb20gJy4uL3NlcnZpY2VzL3RhbWluLXNlY3VyaXR5L3RhbWluLXNlY3VyaXR5LnNlcnZpY2UnO1xyXG5pbXBvcnQge1BlcnNpYW5EYXRlVGltZVBpcGV9IGZyb20gJy4uL3BpcGVzL3BlcnNpYW4tZGF0ZS10aW1lLnBpcGUnO1xyXG5pbXBvcnQge1BlcnNpYW5OdW1iZXJQaXBlfSBmcm9tICcuLi9waXBlcy9wZXJzaWFuLW51bWJlci5waXBlJztcclxuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XHJcbmltcG9ydCB7Rm9ybUJ1aWxkZXIsIEZvcm1Hcm91cH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xyXG5pbXBvcnQge0NvbnN0YW50c1NlcnZpY2V9IGZyb20gJy4uL3NlcnZpY2VzL2NvbnN0YW50cy5zZXJ2aWNlJztcclxuXHJcbmRlY2xhcmUgdmFyIGFsZXJ0aWZ5OiBhbnk7XHJcblxyXG5kZWNsYXJlIGxldCBpbnRyb0pzOiBhbnk7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3RhbWluLXBhZ2UtYmFzZS1jb21wb25lbnQnLFxyXG4gIHRlbXBsYXRlOiAnJyxcclxufSlcclxuZXhwb3J0IGNsYXNzIFRhbWluUGFnZUJhc2VDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgQWZ0ZXJWaWV3SW5pdCwgQWZ0ZXJDb250ZW50Q2hlY2tlZCB7XHJcbiAgcHJpdmF0ZSBfdGl0bGU6IHN0cmluZztcclxuICBwcml2YXRlIG92ZXJsYXlzID0gW107XHJcbiAgcHJpdmF0ZSBfb3ZlcmxheVNlcnZpY2U6IE92ZXJsYXlTZXJ2aWNlO1xyXG4gIHByaXZhdGUgX3Jlc3RTZXJ2aWNlOiBUYW1pblJlc3RTZXJ2aWNlO1xyXG4gIHByaXZhdGUgX3NlY3VyaXR5U2VydmljZTogVGFtaW5TZWN1cml0eVNlcnZpY2U7XHJcbiAgcHJpdmF0ZSBfcGVyc2lhbkRhdGVUaW1lOiBQZXJzaWFuRGF0ZVRpbWVQaXBlO1xyXG4gIHByaXZhdGUgX3BlcnNpYW5OdW1iZXJQaXBlOiBQZXJzaWFuTnVtYmVyUGlwZTtcclxuICBwcml2YXRlIF9yb3V0ZXI6IFJvdXRlcjtcclxuICBwcml2YXRlIF9jb25zdGFudHM6IENvbnN0YW50c1NlcnZpY2U7XHJcbiAgcHJpdmF0ZSBfZm9ybUJ1aWxkZXI6IEZvcm1CdWlsZGVyO1xyXG4gIHByaXZhdGUgX2hvc3Q6IEVsZW1lbnRSZWY7XHJcbiAgcHJpdmF0ZSBfY2hhbmdlRGV0ZWN0b3JSZWY6IENoYW5nZURldGVjdG9yUmVmO1xyXG4gIEBJbnB1dCgpIGlzTW9kYWwgPSBmYWxzZTtcclxuXHJcbiAgQElucHV0KCkgc2V0IHZpc2libGUodmFsOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLl9ob3N0Lm5hdGl2ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IHZhbCA/ICdibG9jaycgOiAnbm9uZSc7XHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGluamVjdG9yOiBJbmplY3Rvcikge1xyXG4gICAgdGhpcy5fb3ZlcmxheVNlcnZpY2UgPSBpbmplY3Rvci5nZXQoT3ZlcmxheVNlcnZpY2UpO1xyXG4gICAgdGhpcy5fcmVzdFNlcnZpY2UgPSBpbmplY3Rvci5nZXQoVGFtaW5SZXN0U2VydmljZSk7XHJcbiAgICB0aGlzLl9zZWN1cml0eVNlcnZpY2UgPSBpbmplY3Rvci5nZXQoVGFtaW5TZWN1cml0eVNlcnZpY2UpO1xyXG4gICAgdGhpcy5fcGVyc2lhbkRhdGVUaW1lID0gaW5qZWN0b3IuZ2V0KFBlcnNpYW5EYXRlVGltZVBpcGUpO1xyXG4gICAgdGhpcy5fcGVyc2lhbk51bWJlclBpcGUgPSBpbmplY3Rvci5nZXQoUGVyc2lhbk51bWJlclBpcGUpO1xyXG4gICAgdGhpcy5fcm91dGVyID0gaW5qZWN0b3IuZ2V0KFJvdXRlcik7XHJcbiAgICB0aGlzLl9mb3JtQnVpbGRlciA9IGluamVjdG9yLmdldChGb3JtQnVpbGRlcik7XHJcbiAgICB0aGlzLl9ob3N0ID0gaW5qZWN0b3IuZ2V0KEVsZW1lbnRSZWYpO1xyXG4gICAgdGhpcy5fY2hhbmdlRGV0ZWN0b3JSZWYgPSBpbmplY3Rvci5nZXQoQ2hhbmdlRGV0ZWN0b3JSZWYpO1xyXG4gICAgdGhpcy5fY29uc3RhbnRzID0gaW5qZWN0b3IuZ2V0KENvbnN0YW50c1NlcnZpY2UpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XHJcbiAgICB0aGlzLmludGVybmFsSW5pdGlhbGl6ZSgpO1xyXG4gICAgdGhpcy5pbml0aWFsaXplUGFnZSgpO1xyXG4gIH1cclxuXHJcbiAgc2V0IHRpdGxlKHZhbDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLl90aXRsZSA9IHZhbDtcclxuICAgIGRvY3VtZW50LnRpdGxlID0gJ9iz2KfYstmF2KfZhiDYqtin2YXbjNmGINin2KzYqtmF2KfYuduMJyArICcgLSAnICsgdGhpcy5fdGl0bGU7XHJcbiAgfVxyXG5cclxuICBnZXQgdGl0bGUoKTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLl90aXRsZTtcclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xyXG4gICAgdGhpcy5vdmVybGF5cy5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHtcclxuICAgICAgdGhpcy5fb3ZlcmxheVNlcnZpY2UuaGlkZShpdGVtLm92ZXJsYXkpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLmRlc3Ryb3lQYWdlKCk7XHJcbiAgICBhbGVydGlmeS5jbG9zZUFsbCgpO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHJlc3RTZXJ2aWNlKCk6IFRhbWluUmVzdFNlcnZpY2Uge1xyXG4gICAgcmV0dXJuIHRoaXMuX3Jlc3RTZXJ2aWNlO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGNvbnN0YW50cygpOiBDb25zdGFudHNTZXJ2aWNlIHtcclxuICAgIHJldHVybiB0aGlzLl9jb25zdGFudHM7XHJcbiAgfVxyXG5cclxuICBnZXQgZm9ybUJ1aWxkZXIoKTogRm9ybUJ1aWxkZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1CdWlsZGVyO1xyXG4gIH1cclxuXHJcbiAgLy8gZ2V0IGN1cnJlbnRVc2VyKCk6IGFueSB7XHJcbiAgLy8gICByZXR1cm4gdGhpcy5fc2VjdXJpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyO1xyXG4gIC8vIH1cclxuXHJcbiAgZ2V0IGNoYW5nZURldGVjdG9yUmVmKCk6IENoYW5nZURldGVjdG9yUmVmIHtcclxuICAgIHJldHVybiB0aGlzLl9jaGFuZ2VEZXRlY3RvclJlZjtcclxuICB9XHJcblxyXG4gIGdldCBzZWN1cml0eVNlcnZpY2UoKTogVGFtaW5TZWN1cml0eVNlcnZpY2Uge1xyXG4gICAgcmV0dXJuIHRoaXMuX3NlY3VyaXR5U2VydmljZTtcclxuICB9XHJcblxyXG4gIGdldFBlcnNpYW5EYXRlKGRhdGU6IGFueSk6IHN0cmluZyB7XHJcbiAgICB0cnkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fcGVyc2lhbkRhdGVUaW1lLnRyYW5zZm9ybShuZXcgRGF0ZShkYXRlKSk7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgcmV0dXJuICfYqtin2LHbjNiuINmG2KfYr9ix2LPYqic7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZWRpcmVjdFRvKHBhdGgpIHtcclxuICAgIHRoaXMuX3JvdXRlci5uYXZpZ2F0ZShbcGF0aF0pO1xyXG4gIH1cclxuXHJcbiAgc2hvd0luZm9NZXNzYWdlQm94KHRpdGxlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgY2FsbGJhY2s6IEZ1bmN0aW9uID0gbnVsbCkge1xyXG4gICAgaWYgKGNhbGxiYWNrKSB7XHJcbiAgICAgIGFsZXJ0aWZ5LmFsZXJ0KHRpdGxlLCBtZXNzYWdlLCBjYWxsYmFjayk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhbGVydGlmeS5hbGVydCh0aXRsZSwgbWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzaG93RXJyb3JNZXNzYWdlQm94KHRpdGxlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgY2FsbGJhY2s6IEZ1bmN0aW9uID0gbnVsbCkge1xyXG4gICAgY29uc3QgdGhlVGl0bGUgPSBgPHNwYW4gc3R5bGU9XCJjb2xvcjogcmVkXCI+JHt0aXRsZX08L3NwYW4+YDtcclxuICAgIGlmIChjYWxsYmFjaykge1xyXG4gICAgICBhbGVydGlmeS5hbGVydCh0aGVUaXRsZSwgbWVzc2FnZSwgY2FsbGJhY2spO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYWxlcnRpZnkuYWxlcnQodGhlVGl0bGUsIG1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2hvd1F1ZXN0aW9uQm94KHRpdGxlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgeWVzQ2FsbGJhY2s6IEZ1bmN0aW9uLCBub0NhbGxiYWNrOiBGdW5jdGlvbikge1xyXG4gICAgYWxlcnRpZnkuY29uZmlybSh0aXRsZSwgbWVzc2FnZSwgeWVzQ2FsbGJhY2ssIG5vQ2FsbGJhY2spXHJcbiAgICAgIC5zZXQoe1xyXG4gICAgICAgIGxhYmVsczoge29rOiAn2KjZhNuMJywgY2FuY2VsOiAn2K7bjNixJ31cclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBzaG93UmV0cnlCb3godGl0bGU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nLCByZXRyeUNhbGxiYWNrOiBGdW5jdGlvbiwgY2FuY2VsQ2FsbGJhY2s6IEZ1bmN0aW9uKSB7XHJcbiAgICBhbGVydGlmeS5jb25maXJtKHRpdGxlLCBtZXNzYWdlLCByZXRyeUNhbGxiYWNrLCBjYW5jZWxDYWxsYmFjaylcclxuICAgICAgLnNldCh7XHJcbiAgICAgICAgbGFiZWxzOiB7b2s6ICfYqtmE2KfYtCDZhdis2K/YrycsIGNhbmNlbDogJ9in2YbYtdix2KfZgSd9LFxyXG4gICAgICAgICdjbG9zYWJsZSc6IGZhbHNlXHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0UGVyc2lhbk51bWJlcihzdHI6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdGhpcy5fcGVyc2lhbk51bWJlclBpcGUudHJhbnNmb3JtKHN0cik7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgaW5pdGlhbGl6ZVBhZ2UoKSB7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgZGVzdHJveVBhZ2UoKSB7XHJcbiAgfVxyXG5cclxuICBzaG93T3ZlcmxheShlbGVtZW50OiBhbnkgPSBudWxsKTogc3RyaW5nIHtcclxuICAgIGlmICh0aGlzLm92ZXJsYXlzLmZpbmRJbmRleChjID0+IGMub3ZlcmxheSA9PT0gZWxlbWVudCkgPj0gMCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBvdmVybGF5ID0gdGhpcy5fb3ZlcmxheVNlcnZpY2Uuc2hvdyhlbGVtZW50KTtcclxuICAgIGNvbnN0IGlkID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcclxuICAgIHRoaXMub3ZlcmxheXMucHVzaCh7XHJcbiAgICAgIG92ZXJsYXk6IG92ZXJsYXksXHJcbiAgICAgIGlkOiBpZC50b1N0cmluZygpXHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpZC50b1N0cmluZygpO1xyXG4gIH1cclxuXHJcbiAgc2hvd092ZXJsYXlXaXRoTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcsIGVsZW1lbnQ6IGFueSA9IG51bGwpOiBzdHJpbmcge1xyXG4gICAgaWYgKHRoaXMub3ZlcmxheXMuZmluZEluZGV4KGMgPT4gYy5vdmVybGF5ID09PSBlbGVtZW50KSA+PSAwKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IG92ZXJsYXkgPSB0aGlzLl9vdmVybGF5U2VydmljZS5zaG93TWVzc2FnZShtZXNzYWdlLCBlbGVtZW50KTtcclxuICAgIGNvbnN0IGlkID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTtcclxuICAgIHRoaXMub3ZlcmxheXMucHVzaCh7XHJcbiAgICAgIG92ZXJsYXk6IG92ZXJsYXksXHJcbiAgICAgIGlkOiBpZC50b1N0cmluZygpXHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpZC50b1N0cmluZygpO1xyXG4gIH1cclxuXHJcbiAgaGlkZU92ZXJsYXkoaWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgdG1wID0gdGhpcy5vdmVybGF5cy5maW5kKGMgPT4gYy5pZCA9PT0gaWQpO1xyXG4gICAgaWYgKHRtcCkge1xyXG4gICAgICB0aGlzLl9vdmVybGF5U2VydmljZS5oaWRlKHRtcC5vdmVybGF5KTtcclxuICAgIH1cclxuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5vdmVybGF5cy5maW5kSW5kZXgoYyA9PiBjLmlkID09PSBpZCk7XHJcbiAgICB0aGlzLm92ZXJsYXlzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGludGVybmFsSW5pdGlhbGl6ZSgpIHtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBsb2FkUGFnZURhdGEoKSB7XHJcbiAgfVxyXG5cclxuICBvblRvdXIoKSB7XHJcbiAgICBpbnRyb0pzKCkuc2V0T3B0aW9ucyhcclxuICAgICAge1xyXG4gICAgICAgICduZXh0TGFiZWwnOiAn2KjYudivJyxcclxuICAgICAgICAncHJldkxhYmVsJzogJ9mC2KjZhCcsXHJcbiAgICAgICAgJ3NraXBMYWJlbCc6ICfYrtix2YjYrCcsXHJcbiAgICAgICAgJ2RvbmVMYWJlbCc6ICfYp9iq2YXYp9mFJ1xyXG4gICAgICB9KS5zdGFydCgpO1xyXG4gIH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmxvYWRQYWdlRGF0YSgpLCAwKTtcclxuICB9XHJcblxyXG4gIG9wZW5Nb2RhbCgpOiBhbnkge1xyXG4gIH1cclxuXHJcbiAgbWFya0Zvcm1Hcm91cEFzVG91Y2hlZChmb3JtOiBGb3JtR3JvdXApIHtcclxuICAgICg8YW55Pk9iamVjdCkudmFsdWVzKGZvcm0uY29udHJvbHMpLmZvckVhY2goY29udHJvbCA9PiBjb250cm9sLm1hcmtBc1RvdWNoZWQoKSk7XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyQ29udGVudENoZWNrZWQoKTogdm9pZCB7XHJcbiAgICB0aGlzLl9jaGFuZ2VEZXRlY3RvclJlZi5kZXRlY3RDaGFuZ2VzKCk7XHJcbiAgfVxyXG59XHJcbiJdfQ==