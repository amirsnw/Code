/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
  Created by: k_kaviani
  Revised by: a_amiri
*/
import { ChangeDetectorRef, Component, ElementRef, HostListener, Input, ViewChild } from '@angular/core';
import { TaminMenuModel } from '../../../models/tamin-menu.model';
import { Router } from '@angular/router';
import { TaminRestService } from '../../../services/tamin-rest-service/tamin-rest.service';
var TaminSiteTopMenuComponent = /** @class */ (function () {
    function TaminSiteTopMenuComponent(taminRestService, router, ref) {
        this.taminRestService = taminRestService;
        this.router = router;
        this.ref = ref;
        this.menuData = new TaminMenuModel();
        this.stack = [];
        this.dummy = true;
    }
    /**
     * @return {?}
     */
    TaminSiteTopMenuComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.taminRestService.getAll(this.restUrl)
            .then((/**
         * @param {?} data
         * @return {?}
         */
        function (data) {
            _this.menuData = data.data;
            _this.stack.push(data.data);
        }))
            .catch((/**
         * @param {?} error
         * @return {?}
         */
        function (error) {
        }));
    };
    /**
     * @param {?} item
     * @return {?}
     */
    TaminSiteTopMenuComponent.prototype.handleMenu = /**
     * @param {?} item
     * @return {?}
     */
    function (item) {
        if (item.disable) {
            alertify.alert('پیام سیستم', 'این خدمت بزودی در اختیار کاربران محترم سازمان تامین اجتماعی قرار خواهد گرفت.');
            return;
        }
        if (item.url !== '') {
            if (item['url-type'] === 'external') {
                window.open(item.url);
            }
            this.router.navigateByUrl('/' + item.url);
            this.dummy = false;
            this.ref.detectChanges();
            this.dummy = true;
            this.ref.detectChanges();
        }
    };
    /**
     * @return {?}
     */
    TaminSiteTopMenuComponent.prototype.toggleMobileMenu = /**
     * @return {?}
     */
    function () {
        if (this.mobileMenuBody.nativeElement.style.display === 'block') {
            this.mobileMenuBody.nativeElement.style.display = 'none';
            this.mobileMenuButton.nativeElement.style.background = '#000a';
            this.mobileMenuButton.nativeElement.style.color = 'white';
        }
        else {
            this.mobileMenuBody.nativeElement.style.display = 'block';
            /** @type {?} */
            var rect = window.document.body.getBoundingClientRect();
            this.mobileMenuBody.nativeElement.style.width = rect.width + 'px';
            this.mobileMenuButton.nativeElement.style.background = '#00779caa';
            this.mobileMenuButton.nativeElement.style.color = 'white';
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    TaminSiteTopMenuComponent.prototype.windowResizeHandler = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var rect = window.document.body.getBoundingClientRect();
        this.mobileMenuBody.nativeElement.style.width = rect.width + 'px';
    };
    /**
     * @param {?} menuItem
     * @return {?}
     */
    TaminSiteTopMenuComponent.prototype.onMobileMenuItemClick = /**
     * @param {?} menuItem
     * @return {?}
     */
    function (menuItem) {
        if (menuItem.items !== undefined && menuItem.items.length !== 0) {
            this.stack.push(menuItem);
        }
    };
    /**
     * @return {?}
     */
    TaminSiteTopMenuComponent.prototype.onMobileMenuReturn = /**
     * @return {?}
     */
    function () {
        this.stack.pop();
    };
    TaminSiteTopMenuComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tamin-site-top-menu',
                    template: "<!--\n  Created by: k_kaviani\n  Revised by: a_amiri\n-->\n<nav class=\"desktop\" *ngIf=\"dummy\">\n  <ul>\n    <li *ngFor=\"let item1 of menuData.items\">\n      <a (click)=\"handleMenu(item1)\" [ngClass]=\"{'disable':item1.disable}\">{{item1.caption}}</a>\n      <ul *ngIf=\"item1.items !== undefined\" class=\"child\">\n        <li *ngFor=\"let item2 of item1.items\">\n          <a (click)=\"handleMenu(item2)\" [ngClass]=\"{'hasSubItem':item2.items !== undefined, 'disable':item2.disable}\">{{item2.caption}}</a>\n          <ul *ngIf=\"item2.items !== undefined\" class=\"child\">\n            <li *ngFor=\"let item3 of item2.items\" [ngClass]=\"{'disable':item3.disable}\">\n              <a (click)=\"handleMenu(item3)\">{{item3.caption}}</a>\n            </li>\n          </ul>\n        </li>\n      </ul>\n    </li>\n  </ul>\n</nav>\n\n<nav class=\"mobile\" *ngIf=\"dummy\">\n  <ul>\n    <li>\n      <a (click)=\"toggleMobileMenu()\" #mobileMenuButton style=\"border-radius:0\"><i class=\"icon-menu\"></i></a>\n      <ul class=\"child\" #mobileMenuBody>\n        <li *ngIf=\"stack.length !== 1\"><a (click)=\"onMobileMenuReturn()\"><i class=\"icon-right-open\"\n                                                                            style=\"margin-left: 5px\"></i>\u0628\u0627\u0632\u06AF\u0634\u062A</a></li>\n        <li *ngFor=\"let item of stack[stack.length-1]?.items\" (click)=\"onMobileMenuItemClick(item)\">\n          <a (click)=\"handleMenu(item)\">{{item.caption}}</a></li>\n      </ul>\n    </li>\n  </ul>\n</nav>\n",
                    styles: [".disable{background-color:rgba(119,119,119,.67)}nav.desktop{text-align:right;width:100%;position:static}nav.desktop a{margin:0;background-color:transparent;cursor:pointer}nav.desktop ul li:hover>ul{display:block}nav.desktop ul{background:rgba(173,173,173,.6);border:1px solid #0009;list-style:none;position:relative;z-index:1000}nav.desktop ul:after{content:\"\";clear:both;display:block}nav.desktop ul li{float:right;position:relative;font-weight:700}nav.desktop ul li:hover{background:rgba(0,0,0,.67)}nav.desktop ul li:hover a{color:#fff}nav.desktop ul li a{display:block;padding:10px 15px;color:#333;text-decoration:none}nav.desktop ul ul{display:none;background:rgba(0,0,0,.67);border-radius:0;padding:0;position:absolute;top:100%;right:0;min-width:300px}nav.desktop ul ul li{float:none;position:relative}nav.desktop ul ul li a{padding:10px 15px;color:#fff}nav.desktop a.hasSubItem:after{font-family:fontello;content:'\\e804';float:left;margin-top:4px}nav.desktop ul ul li a:hover{background:rgba(44,123,175,.67)}nav.desktop ul ul ul{position:absolute;right:100%;top:0}nav.mobile{text-align:right;width:100%;display:none}nav.mobile a{margin:0;background-color:transparent;cursor:pointer}nav.mobile ul{background:rgba(51,64,75,.6);border:1px solid #555;list-style:none;position:relative;z-index:1000}nav.mobile ul:after{content:\"\";clear:both;display:block}nav.mobile ul li{float:right;position:relative;font-weight:700}nav.mobile ul li a{display:block;padding:10px 15px;color:#fff;text-decoration:none}nav.mobile ul ul{display:none;background:rgba(0,0,0,.85);border-radius:0;padding:0;position:absolute;top:100%;right:0}nav.mobile ul ul li{float:none;position:relative}nav.mobile ul ul li a{padding:10px 15px;color:#fff}nav.mobile a.hasSubItem:after{font-family:fontello;content:'\\e804';float:left;margin-top:4px}nav.mobile ul ul li a:hover{background:rgba(255,255,255,.33)}nav.mobile ul ul ul{position:absolute;right:100%;top:0}@media screen and (max-width:767px),(orientation:portrait){nav.desktop{display:none}nav.mobile{display:block}}"]
                }] }
    ];
    /** @nocollapse */
    TaminSiteTopMenuComponent.ctorParameters = function () { return [
        { type: TaminRestService },
        { type: Router },
        { type: ChangeDetectorRef }
    ]; };
    TaminSiteTopMenuComponent.propDecorators = {
        desktopMenu: [{ type: ViewChild, args: ['desktopMenu',] }],
        mobileMenu: [{ type: ViewChild, args: ['mobileMenu',] }],
        topMenu: [{ type: ViewChild, args: ['topMenu',] }],
        menuElement: [{ type: ViewChild, args: ['menuElement',] }],
        mobileMenuBody: [{ type: ViewChild, args: ['mobileMenuBody',] }],
        mobileMenuButton: [{ type: ViewChild, args: ['mobileMenuButton',] }],
        restUrl: [{ type: Input }],
        windowResizeHandler: [{ type: HostListener, args: ['window:resize', ['$event'],] }]
    };
    return TaminSiteTopMenuComponent;
}());
export { TaminSiteTopMenuComponent };
if (false) {
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.desktopMenu;
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.mobileMenu;
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.topMenu;
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.menuElement;
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.mobileMenuBody;
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.mobileMenuButton;
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.restUrl;
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.menuData;
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.stack;
    /** @type {?} */
    TaminSiteTopMenuComponent.prototype.dummy;
    /**
     * @type {?}
     * @private
     */
    TaminSiteTopMenuComponent.prototype.taminRestService;
    /**
     * @type {?}
     * @private
     */
    TaminSiteTopMenuComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    TaminSiteTopMenuComponent.prototype.ref;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFtaW4tc2l0ZS10b3AtbWVudS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly90YW1pbi1mcmFtZXdvcmsvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy90YW1pbi1zaXRlL3RhbWluLXNpdGUtdG9wLW1lbnUvdGFtaW4tc2l0ZS10b3AtbWVudS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFLQSxPQUFPLEVBQUMsaUJBQWlCLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFVLFNBQVMsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUMvRyxPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sa0NBQWtDLENBQUM7QUFFaEUsT0FBTyxFQUFDLE1BQU0sRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBQ3ZDLE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLHlEQUF5RCxDQUFDO0FBSXpGO0lBaUJFLG1DQUFvQixnQkFBa0MsRUFBVSxNQUFjLEVBQVUsR0FBc0I7UUFBMUYscUJBQWdCLEdBQWhCLGdCQUFnQixDQUFrQjtRQUFVLFdBQU0sR0FBTixNQUFNLENBQVE7UUFBVSxRQUFHLEdBQUgsR0FBRyxDQUFtQjtRQUp2RyxhQUFRLEdBQW1CLElBQUksY0FBYyxFQUFFLENBQUM7UUFDdkQsVUFBSyxHQUEwQixFQUFFLENBQUM7UUFDbEMsVUFBSyxHQUFHLElBQUksQ0FBQztJQUdiLENBQUM7Ozs7SUFFRCw0Q0FBUTs7O0lBQVI7UUFBQSxpQkFRQztRQVBDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQzthQUN2QyxJQUFJOzs7O1FBQUMsVUFBQSxJQUFJO1lBQ1IsS0FBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1lBQzFCLEtBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM3QixDQUFDLEVBQUM7YUFDRCxLQUFLOzs7O1FBQUMsVUFBQSxLQUFLO1FBQ1osQ0FBQyxFQUFDLENBQUM7SUFDUCxDQUFDOzs7OztJQUVELDhDQUFVOzs7O0lBQVYsVUFBVyxJQUFvQjtRQUM3QixJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDaEIsUUFBUSxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsOEVBQThFLENBQUMsQ0FBQztZQUM3RyxPQUFPO1NBQ1I7UUFDRCxJQUFJLElBQUksQ0FBQyxHQUFHLEtBQUssRUFBRSxFQUFFO1lBQ25CLElBQUksSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLFVBQVUsRUFBRTtnQkFDbkMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7YUFDdkI7WUFDRCxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQzFDLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1lBQ25CLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDekIsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7WUFDbEIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsQ0FBQztTQUMxQjtJQUNILENBQUM7Ozs7SUFFRCxvREFBZ0I7OztJQUFoQjtRQUNFLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLE9BQU8sS0FBSyxPQUFPLEVBQUU7WUFDL0QsSUFBSSxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7WUFDekQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsVUFBVSxHQUFHLE9BQU8sQ0FBQztZQUMvRCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsT0FBTyxDQUFDO1NBQzNEO2FBQU07WUFDTCxJQUFJLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQzs7Z0JBQ3BELElBQUksR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRTtZQUN6RCxJQUFJLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1lBQ2xFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLFVBQVUsR0FBRyxXQUFXLENBQUM7WUFDbkUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLE9BQU8sQ0FBQztTQUMzRDtJQUNILENBQUM7Ozs7O0lBR0QsdURBQW1COzs7O0lBRG5CLFVBQ29CLEtBQUs7O1lBQ2pCLElBQUksR0FBRyxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRTtRQUN6RCxJQUFJLENBQUMsY0FBYyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO0lBQ3BFLENBQUM7Ozs7O0lBRUQseURBQXFCOzs7O0lBQXJCLFVBQXNCLFFBQVE7UUFDNUIsSUFBSSxRQUFRLENBQUMsS0FBSyxLQUFLLFNBQVMsSUFBSSxRQUFRLENBQUMsS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDL0QsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDM0I7SUFDSCxDQUFDOzs7O0lBRUQsc0RBQWtCOzs7SUFBbEI7UUFDRSxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBQ25CLENBQUM7O2dCQTNFRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLHFCQUFxQjtvQkFDL0IsaWhEQUFtRDs7aUJBRXBEOzs7O2dCQVJPLGdCQUFnQjtnQkFEaEIsTUFBTTtnQkFITixpQkFBaUI7Ozs4QkFjdEIsU0FBUyxTQUFDLGFBQWE7NkJBQ3ZCLFNBQVMsU0FBQyxZQUFZOzBCQUN0QixTQUFTLFNBQUMsU0FBUzs4QkFDbkIsU0FBUyxTQUFDLGFBQWE7aUNBQ3ZCLFNBQVMsU0FBQyxnQkFBZ0I7bUNBQzFCLFNBQVMsU0FBQyxrQkFBa0I7MEJBQzVCLEtBQUs7c0NBaURMLFlBQVksU0FBQyxlQUFlLEVBQUUsQ0FBQyxRQUFRLENBQUM7O0lBZTNDLGdDQUFDO0NBQUEsQUE1RUQsSUE0RUM7U0F2RVkseUJBQXlCOzs7SUFDcEMsZ0RBQWtEOztJQUNsRCwrQ0FBZ0Q7O0lBQ2hELDRDQUEwQzs7SUFDMUMsZ0RBQWtEOztJQUNsRCxtREFBd0Q7O0lBQ3hELHFEQUE0RDs7SUFDNUQsNENBQXlCOztJQUN6Qiw2Q0FBdUQ7O0lBQ3ZELDBDQUFrQzs7SUFDbEMsMENBQWE7Ozs7O0lBRUQscURBQTBDOzs7OztJQUFFLDJDQUFzQjs7Ozs7SUFBRSx3Q0FBOEIiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICBDcmVhdGVkIGJ5OiBrX2thdmlhbmlcbiAgUmV2aXNlZCBieTogYV9hbWlyaVxuKi9cblxuaW1wb3J0IHtDaGFuZ2VEZXRlY3RvclJlZiwgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBIb3N0TGlzdGVuZXIsIElucHV0LCBPbkluaXQsIFZpZXdDaGlsZH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1RhbWluTWVudU1vZGVsfSBmcm9tICcuLi8uLi8uLi9tb2RlbHMvdGFtaW4tbWVudS5tb2RlbCc7XG5pbXBvcnQge0dlbmVyaWNSZXN0U2VydmljZX0gZnJvbSAnLi4vLi4vLi4vc2VydmljZXMvZ2VuZXJpYy1yZXN0LXNlcnZpY2UvZ2VuZXJpYy1yZXN0LnNlcnZpY2UnO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQge1RhbWluUmVzdFNlcnZpY2V9IGZyb20gJy4uLy4uLy4uL3NlcnZpY2VzL3RhbWluLXJlc3Qtc2VydmljZS90YW1pbi1yZXN0LnNlcnZpY2UnO1xuXG5kZWNsYXJlIHZhciBhbGVydGlmeTogYW55O1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0YW1pbi1zaXRlLXRvcC1tZW51JyxcbiAgdGVtcGxhdGVVcmw6ICcuL3RhbWluLXNpdGUtdG9wLW1lbnUuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi90YW1pbi1zaXRlLXRvcC1tZW51LmNvbXBvbmVudC5zY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgVGFtaW5TaXRlVG9wTWVudUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIEBWaWV3Q2hpbGQoJ2Rlc2t0b3BNZW51JykgZGVza3RvcE1lbnU6IEVsZW1lbnRSZWY7XG4gIEBWaWV3Q2hpbGQoJ21vYmlsZU1lbnUnKSBtb2JpbGVNZW51OiBFbGVtZW50UmVmO1xuICBAVmlld0NoaWxkKCd0b3BNZW51JykgdG9wTWVudTogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnbWVudUVsZW1lbnQnKSBtZW51RWxlbWVudDogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnbW9iaWxlTWVudUJvZHknKSBtb2JpbGVNZW51Qm9keTogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnbW9iaWxlTWVudUJ1dHRvbicpIG1vYmlsZU1lbnVCdXR0b246IEVsZW1lbnRSZWY7XG4gIEBJbnB1dCgpIHJlc3RVcmw6IHN0cmluZztcbiAgcHVibGljIG1lbnVEYXRhOiBUYW1pbk1lbnVNb2RlbCA9IG5ldyBUYW1pbk1lbnVNb2RlbCgpO1xuICBzdGFjazogQXJyYXk8VGFtaW5NZW51TW9kZWw+ID0gW107XG4gIGR1bW15ID0gdHJ1ZTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHRhbWluUmVzdFNlcnZpY2U6IFRhbWluUmVzdFNlcnZpY2UsIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsIHByaXZhdGUgcmVmOiBDaGFuZ2VEZXRlY3RvclJlZikge1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy50YW1pblJlc3RTZXJ2aWNlLmdldEFsbCh0aGlzLnJlc3RVcmwpXG4gICAgICAudGhlbihkYXRhID0+IHtcbiAgICAgICAgdGhpcy5tZW51RGF0YSA9IGRhdGEuZGF0YTtcbiAgICAgICAgdGhpcy5zdGFjay5wdXNoKGRhdGEuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlTWVudShpdGVtOiBUYW1pbk1lbnVNb2RlbCkge1xuICAgIGlmIChpdGVtLmRpc2FibGUpIHtcbiAgICAgIGFsZXJ0aWZ5LmFsZXJ0KCfZvtuM2KfZhSDYs9uM2LPYqtmFJywgJ9in24zZhiDYrtiv2YXYqiDYqNiy2YjYr9uMINiv2LEg2KfYrtiq24zYp9ixINqp2KfYsdio2LHYp9mGINmF2K3Yqtix2YUg2LPYp9iy2YXYp9mGINiq2KfZhduM2YYg2KfYrNiq2YXYp9i524wg2YLYsdin2LEg2K7ZiNin2YfYryDar9ix2YHYqi4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGl0ZW0udXJsICE9PSAnJykge1xuICAgICAgaWYgKGl0ZW1bJ3VybC10eXBlJ10gPT09ICdleHRlcm5hbCcpIHtcbiAgICAgICAgd2luZG93Lm9wZW4oaXRlbS51cmwpO1xuICAgICAgfVxuICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGVCeVVybCgnLycgKyBpdGVtLnVybCk7XG4gICAgICB0aGlzLmR1bW15ID0gZmFsc2U7XG4gICAgICB0aGlzLnJlZi5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICB0aGlzLmR1bW15ID0gdHJ1ZTtcbiAgICAgIHRoaXMucmVmLmRldGVjdENoYW5nZXMoKTtcbiAgICB9XG4gIH1cblxuICB0b2dnbGVNb2JpbGVNZW51KCkge1xuICAgIGlmICh0aGlzLm1vYmlsZU1lbnVCb2R5Lm5hdGl2ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJykge1xuICAgICAgdGhpcy5tb2JpbGVNZW51Qm9keS5uYXRpdmVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICB0aGlzLm1vYmlsZU1lbnVCdXR0b24ubmF0aXZlRWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDBhJztcbiAgICAgIHRoaXMubW9iaWxlTWVudUJ1dHRvbi5uYXRpdmVFbGVtZW50LnN0eWxlLmNvbG9yID0gJ3doaXRlJztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tb2JpbGVNZW51Qm9keS5uYXRpdmVFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgY29uc3QgcmVjdCA9IHdpbmRvdy5kb2N1bWVudC5ib2R5LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgdGhpcy5tb2JpbGVNZW51Qm9keS5uYXRpdmVFbGVtZW50LnN0eWxlLndpZHRoID0gcmVjdC53aWR0aCArICdweCc7XG4gICAgICB0aGlzLm1vYmlsZU1lbnVCdXR0b24ubmF0aXZlRWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kID0gJyMwMDc3OWNhYSc7XG4gICAgICB0aGlzLm1vYmlsZU1lbnVCdXR0b24ubmF0aXZlRWxlbWVudC5zdHlsZS5jb2xvciA9ICd3aGl0ZSc7XG4gICAgfVxuICB9XG5cbiAgQEhvc3RMaXN0ZW5lcignd2luZG93OnJlc2l6ZScsIFsnJGV2ZW50J10pXG4gIHdpbmRvd1Jlc2l6ZUhhbmRsZXIoZXZlbnQpIHtcbiAgICBjb25zdCByZWN0ID0gd2luZG93LmRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgdGhpcy5tb2JpbGVNZW51Qm9keS5uYXRpdmVFbGVtZW50LnN0eWxlLndpZHRoID0gcmVjdC53aWR0aCArICdweCc7XG4gIH1cblxuICBvbk1vYmlsZU1lbnVJdGVtQ2xpY2sobWVudUl0ZW0pIHtcbiAgICBpZiAobWVudUl0ZW0uaXRlbXMgIT09IHVuZGVmaW5lZCAmJiBtZW51SXRlbS5pdGVtcy5sZW5ndGggIT09IDApIHtcbiAgICAgIHRoaXMuc3RhY2sucHVzaChtZW51SXRlbSk7XG4gICAgfVxuICB9XG5cbiAgb25Nb2JpbGVNZW51UmV0dXJuKCkge1xuICAgIHRoaXMuc3RhY2sucG9wKCk7XG4gIH1cbn1cbiJdfQ==